---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-cs
title: 声明性参数 (C#) |Microsoft Docs
author: rick-anderson
description: 在本教程中我们将演示了如何将参数设置为硬编码值用于选择要显示的 DetailsView 控件中的数据。
ms.author: aspnetcontent
ms.date: 03/31/2010
ms.assetid: 603c9bd3-b895-4ec6-853b-0c81ff36d580
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-cs
msc.type: authoredcontent
ms.openlocfilehash: 06577628d2b502df2854a83af564a0c0d402e9bd
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/05/2018
ms.locfileid: "37839420"
---
<a name="declarative-parameters-c"></a><span data-ttu-id="71b6a-103">声明性参数 (C#)</span><span class="sxs-lookup"><span data-stu-id="71b6a-103">Declarative Parameters (C#)</span></span>
====================
<span data-ttu-id="71b6a-104">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="71b6a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="71b6a-105">[下载示例应用程序](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_5_CS.exe)或[下载 PDF](declarative-parameters-cs/_static/datatutorial05cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="71b6a-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_5_CS.exe) or [Download PDF](declarative-parameters-cs/_static/datatutorial05cs1.pdf)</span></span>

> <span data-ttu-id="71b6a-106">在本教程中我们将演示了如何将参数设置为硬编码值用于选择要显示的 DetailsView 控件中的数据。</span><span class="sxs-lookup"><span data-stu-id="71b6a-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>


## <a name="introduction"></a><span data-ttu-id="71b6a-107">介绍</span><span class="sxs-lookup"><span data-stu-id="71b6a-107">Introduction</span></span>

<span data-ttu-id="71b6a-108">在中[最后一个教程](displaying-data-with-the-objectdatasource-cs.md)我们在使用绑定到调用的 ObjectDataSource 控件的 GridView、 DetailsView 和 FormView 控件显示数据`GetProducts()`方法从`ProductsBLL`类。</span><span class="sxs-lookup"><span data-stu-id="71b6a-108">In the [last tutorial](displaying-data-with-the-objectdatasource-cs.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="71b6a-109">`GetProducts()`方法返回填充的 Northwind 数据库中记录所有的强类型化 DataTable`Products`表。</span><span class="sxs-lookup"><span data-stu-id="71b6a-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="71b6a-110">`ProductsBLL`类包含用于返回只需子集的产品的其他方法`GetProductByProductID(productID)`， `GetProductsByCategoryID(categoryID)`，和`GetProductsBySupplierID(supplierID)`。</span><span class="sxs-lookup"><span data-stu-id="71b6a-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="71b6a-111">这三种方法需要输入的参数，该值指示如何筛选返回的产品信息。</span><span class="sxs-lookup"><span data-stu-id="71b6a-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="71b6a-112">调用方法的预期的输入的参数，但为了实现这一点我们必须指定这些参数的值来自何处，可以使用对象数据源。</span><span class="sxs-lookup"><span data-stu-id="71b6a-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="71b6a-113">参数值可以是硬编码，也可以来自各种动态源，包括： 查询字符串值，会话变量上页上，或其他人的 Web 控件的属性值。</span><span class="sxs-lookup"><span data-stu-id="71b6a-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="71b6a-114">对于本教程首先阐释如何使用一个参数设置为硬编码值。</span><span class="sxs-lookup"><span data-stu-id="71b6a-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="71b6a-115">具体而言，我们将介绍添加到显示有关特定产品，即 Chef 秋葵汤，它具有的信息的页面的 DetailsView`ProductID`为 5。</span><span class="sxs-lookup"><span data-stu-id="71b6a-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="71b6a-116">接下来，我们将了解如何设置基于 Web 控件的参数值。</span><span class="sxs-lookup"><span data-stu-id="71b6a-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="71b6a-117">具体而言，我们将使用一个文本框，用户可在一个国家/地区，此后它们可以单击按钮以查看驻留在该国家/地区的供应商提供的列表中键入。</span><span class="sxs-lookup"><span data-stu-id="71b6a-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="71b6a-118">使用硬编码参数值</span><span class="sxs-lookup"><span data-stu-id="71b6a-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="71b6a-119">第一个示例中，首先，通过添加到的 DetailsView 控件`DeclarativeParams.aspx`页中`BasicReporting`文件夹。</span><span class="sxs-lookup"><span data-stu-id="71b6a-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="71b6a-120">从 DetailsView 的智能标记上，选择&lt;新数据源&gt;从下拉列表，然后选择要添加对象数据源。</span><span class="sxs-lookup"><span data-stu-id="71b6a-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>


<span data-ttu-id="71b6a-121">[![将对象数据源添加到页面](declarative-parameters-cs/_static/image2.png)](declarative-parameters-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-121">[![Add an ObjectDataSource to the Page](declarative-parameters-cs/_static/image2.png)](declarative-parameters-cs/_static/image1.png)</span></span>

<span data-ttu-id="71b6a-122">**图 1**： 将对象数据源添加到页 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-cs/_static/image3.png))</span></span>


<span data-ttu-id="71b6a-123">这将自动启动 ObjectDataSource 控件选择数据源向导。</span><span class="sxs-lookup"><span data-stu-id="71b6a-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="71b6a-124">选择`ProductsBLL`向导的第一个屏幕中的类。</span><span class="sxs-lookup"><span data-stu-id="71b6a-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>


<span data-ttu-id="71b6a-125">[![选择 ProductsBLL 类](declarative-parameters-cs/_static/image5.png)](declarative-parameters-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-125">[![Select the ProductsBLL Class](declarative-parameters-cs/_static/image5.png)](declarative-parameters-cs/_static/image4.png)</span></span>

<span data-ttu-id="71b6a-126">**图 2**： 选择`ProductsBLL`类 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-cs/_static/image6.png))</span></span>


<span data-ttu-id="71b6a-127">由于我们想要显示有关特定产品的信息，因此我们想要使用`GetProductByProductID(productID)`方法。</span><span class="sxs-lookup"><span data-stu-id="71b6a-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="71b6a-128">[![选择 GetProductByProductID(productID) 方法](declarative-parameters-cs/_static/image8.png)](declarative-parameters-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-cs/_static/image8.png)](declarative-parameters-cs/_static/image7.png)</span></span>

<span data-ttu-id="71b6a-129">**图 3**： 选择`GetProductByProductID(productID)`方法 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-cs/_static/image9.png))</span></span>


<span data-ttu-id="71b6a-130">由于我们选择的方法包括参数，没有一个向导，其中我们需要定义要用于参数的值的多个屏幕。</span><span class="sxs-lookup"><span data-stu-id="71b6a-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="71b6a-131">在左侧的列表显示所有所选方法的参数。</span><span class="sxs-lookup"><span data-stu-id="71b6a-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="71b6a-132">有关`GetProductByProductID(productID)`只有一个`productID`。</span><span class="sxs-lookup"><span data-stu-id="71b6a-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="71b6a-133">在右侧，我们可以指定所选的参数的值。</span><span class="sxs-lookup"><span data-stu-id="71b6a-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="71b6a-134">参数源下拉列表枚举为参数值的各种可能来源。</span><span class="sxs-lookup"><span data-stu-id="71b6a-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="71b6a-135">由于我们想要指定硬编码值为 5`productID`参数保留为无参数源和默认值文本框中输入 5。</span><span class="sxs-lookup"><span data-stu-id="71b6a-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>


<span data-ttu-id="71b6a-136">[![Hard-Coded 参数值的 5 将用于产品 id 参数](declarative-parameters-cs/_static/image11.png)](declarative-parameters-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-cs/_static/image11.png)](declarative-parameters-cs/_static/image10.png)</span></span>

<span data-ttu-id="71b6a-137">**图 4**: A Hard-Coded 参数值的 5 将用于`productID`参数 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-cs/_static/image12.png))</span></span>


<span data-ttu-id="71b6a-138">完成配置数据源向导后，ObjectDataSource 控件声明性标记包含`Parameter`中的对象`SelectParameters`集合中定义的方法所需的输入参数的每个`SelectMethod`属性。</span><span class="sxs-lookup"><span data-stu-id="71b6a-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="71b6a-139">由于我们在此示例中使用的方法应只的单个输入的参数， `parameterID`，这里只有一个条目。</span><span class="sxs-lookup"><span data-stu-id="71b6a-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="71b6a-140">`SelectParameters`集合可以包含任何类都派生自`Parameter`类中`System.Web.UI.WebControls`命名空间。</span><span class="sxs-lookup"><span data-stu-id="71b6a-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="71b6a-141">硬编码参数值基`Parameter`类，但源选项的其他参数派生`Parameter`类; 您也可以创建你自己[自定义参数类型](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11)，如果需要。</span><span class="sxs-lookup"><span data-stu-id="71b6a-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-cs/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="71b6a-142">如果您要按照你自己的计算机上声明性标记你此时看到可能包括值`InsertMethod`， `UpdateMethod`，并`DeleteMethod`属性，以及`DeleteParameters`。</span><span class="sxs-lookup"><span data-stu-id="71b6a-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="71b6a-143">ObjectDataSource 的选择数据源向导自动指定的方法从`ProductBLL`要用于插入、 更新和删除，因此除非你显式清除了这些情况，则它们将包含在上面的标记。</span><span class="sxs-lookup"><span data-stu-id="71b6a-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>


<span data-ttu-id="71b6a-144">Web 控件的数据时访问此页，将调用 ObjectDataSource`Select`方法，将调用`ProductsBLL`类的`GetProductByProductID(productID)`方法使用硬编码值为 5`productID`输入的参数。</span><span class="sxs-lookup"><span data-stu-id="71b6a-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="71b6a-145">该方法将返回一个强类型`ProductDataTable`对象，其中包含一个行，以了解 Chef 秋葵汤 (与产品`ProductID`5)。</span><span class="sxs-lookup"><span data-stu-id="71b6a-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>


<span data-ttu-id="71b6a-146">[![显示信息有关 Chef 秋葵汤](declarative-parameters-cs/_static/image14.png)](declarative-parameters-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-cs/_static/image14.png)](declarative-parameters-cs/_static/image13.png)</span></span>

<span data-ttu-id="71b6a-147">**图 5**： 显示信息有关 Chef 秋葵汤 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-cs/_static/image15.png))</span></span>


## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="71b6a-148">将参数值设置为 Web 控件的属性值</span><span class="sxs-lookup"><span data-stu-id="71b6a-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="71b6a-149">ObjectDataSource 的参数值也可以设置基于页上的 Web 控件的值。</span><span class="sxs-lookup"><span data-stu-id="71b6a-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="71b6a-150">若要说明这一点，让我们具有一个 GridView，列出所有用户指定的国家/地区中的供应商。</span><span class="sxs-lookup"><span data-stu-id="71b6a-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="71b6a-151">若要完成本教程通过将文本框添加到用户可以在其中输入国家/地区名称页。</span><span class="sxs-lookup"><span data-stu-id="71b6a-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="71b6a-152">设置此文本框控件`ID`属性设置为`CountryName`。</span><span class="sxs-lookup"><span data-stu-id="71b6a-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="71b6a-153">此外添加一个按钮 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="71b6a-153">Also add a Button Web control.</span></span>


<span data-ttu-id="71b6a-154">[![将文本框添加到具有 ID 国家/地区名称的页面](declarative-parameters-cs/_static/image17.png)](declarative-parameters-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-cs/_static/image17.png)](declarative-parameters-cs/_static/image16.png)</span></span>

<span data-ttu-id="71b6a-155">**图 6**： 将 TextBox 添加到包含的页`ID` `CountryName` ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-cs/_static/image18.png))</span></span>


<span data-ttu-id="71b6a-156">接下来，添加一个 GridView，页上，并从智能标记中，选择添加新对象数据源。</span><span class="sxs-lookup"><span data-stu-id="71b6a-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="71b6a-157">由于我们想要显示供应商信息选择`SuppliersBLL`从向导的第一个屏幕的类。</span><span class="sxs-lookup"><span data-stu-id="71b6a-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="71b6a-158">从第二个屏幕上，选择`GetSuppliersByCountry(country)`方法。</span><span class="sxs-lookup"><span data-stu-id="71b6a-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>


<span data-ttu-id="71b6a-159">[![选择 GetSuppliersByCountry(country) 方法](declarative-parameters-cs/_static/image20.png)](declarative-parameters-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-cs/_static/image20.png)](declarative-parameters-cs/_static/image19.png)</span></span>

<span data-ttu-id="71b6a-160">**图 7**： 选择`GetSuppliersByCountry(country)`方法 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-cs/_static/image21.png))</span></span>


<span data-ttu-id="71b6a-161">由于`GetSuppliersByCountry(country)`方法具有一个输入的参数，该向导再一次包括选择参数值的最后一个屏幕。</span><span class="sxs-lookup"><span data-stu-id="71b6a-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="71b6a-162">这一次，设置参数源为控件。</span><span class="sxs-lookup"><span data-stu-id="71b6a-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="71b6a-163">这将填充 ControlID 下拉列表的页面; 上的控件名称选择`CountryName`从列表中的控件。</span><span class="sxs-lookup"><span data-stu-id="71b6a-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="71b6a-164">首次访问页面时`CountryName`文本框将为空白，因此不返回任何结果并不显示任何内容。</span><span class="sxs-lookup"><span data-stu-id="71b6a-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="71b6a-165">如果你想要显示一些结果，默认情况下，请相应地设置默认值文本框中。</span><span class="sxs-lookup"><span data-stu-id="71b6a-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>


<span data-ttu-id="71b6a-166">[![将参数值设置为国家/地区名称控件值](declarative-parameters-cs/_static/image23.png)](declarative-parameters-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-cs/_static/image23.png)](declarative-parameters-cs/_static/image22.png)</span></span>

<span data-ttu-id="71b6a-167">**图 8**： 将参数值设置为`CountryName`控制值 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-cs/_static/image24.png))</span></span>


<span data-ttu-id="71b6a-168">ObjectDataSource 的声明性标记稍有不同我们第一个示例中，使用[ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx)而不是标准`Parameter`对象。</span><span class="sxs-lookup"><span data-stu-id="71b6a-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="71b6a-169">一个`ControlParameter`具有其他属性来指定`ID`的 Web 控件和要使用的参数的属性值 (`PropertyName`)。</span><span class="sxs-lookup"><span data-stu-id="71b6a-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="71b6a-170">配置数据源向导很智能，可以确定，文本框中，我们可能想要使用`Text`参数值的属性。</span><span class="sxs-lookup"><span data-stu-id="71b6a-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="71b6a-171">如果你想要使用不同的属性值从 Web 控件的但是，可以更改`PropertyName`值此处或通过单击向导中的"显示高级属性"链接。</span><span class="sxs-lookup"><span data-stu-id="71b6a-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-cs/samples/sample2.aspx)]

<span data-ttu-id="71b6a-172">第一次访问页面时`CountryName`文本框为空。</span><span class="sxs-lookup"><span data-stu-id="71b6a-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="71b6a-173">ObjectDataSource `Select` GridView 中，但值仍调用方法`null`传递到`GetSuppliersByCountry(country)`方法。</span><span class="sxs-lookup"><span data-stu-id="71b6a-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `null` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="71b6a-174">将转换 TableAdapter`null`到数据库`NULL`值 (`DBNull.Value`)，但使用的查询`GetSuppliersByCountry(country)`方法这样编写的它不会返回任何值时`NULL`为指定值`@CategoryID`参数。</span><span class="sxs-lookup"><span data-stu-id="71b6a-174">The TableAdapter converts the `null` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="71b6a-175">简单地说，不返回的任何供应商。</span><span class="sxs-lookup"><span data-stu-id="71b6a-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="71b6a-176">访问者在国家/地区，但是，输入，并单击显示供应商按钮会导致回发中，ObjectDataSource 的后`Select`方法重新查询，在 TextBox 控件中传递`Text`值作为`country`参数。</span><span class="sxs-lookup"><span data-stu-id="71b6a-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>


<span data-ttu-id="71b6a-177">[![显示来自加拿大这些供应商](declarative-parameters-cs/_static/image26.png)](declarative-parameters-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-177">[![Those Suppliers from Canada are Shown](declarative-parameters-cs/_static/image26.png)](declarative-parameters-cs/_static/image25.png)</span></span>

<span data-ttu-id="71b6a-178">**图 9**： 显示这些供应商来自加拿大 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-cs/_static/image27.png))</span></span>


## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="71b6a-179">显示默认情况下的所有供应商</span><span class="sxs-lookup"><span data-stu-id="71b6a-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="71b6a-180">而是不是首先查看网页时显示供应商提供的任何我们可能想要显示*所有*供应商在第一个，这样就允许用户通过在文本框中输入国家/地区名称列表中向下将端点。</span><span class="sxs-lookup"><span data-stu-id="71b6a-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="71b6a-181">当文本框为空，`SuppliersBLL`类的`GetSuppliersByCountry(country)`方法传入`null`值及其*`country`* 输入的参数。</span><span class="sxs-lookup"><span data-stu-id="71b6a-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in a `null` value for its *`country`* input parameter.</span></span> <span data-ttu-id="71b6a-182">这`null`值然后传到 DAL`GetSupplierByCountry(country)`方法，它将转换到的数据库`NULL`值`@Country`在下面的查询参数：</span><span class="sxs-lookup"><span data-stu-id="71b6a-182">This `null` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-cs/samples/sample3.sql)]

<span data-ttu-id="71b6a-183">表达式`Country = NULL`始终返回 False，即使对于记录其`Country`列为`NULL`值; 因此，返回任何记录。</span><span class="sxs-lookup"><span data-stu-id="71b6a-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="71b6a-184">若要返回*所有*供应商的国家/地区文本框为空时，我们可以增强`GetSuppliersByCountry(country)`中 BLL 要调用的方法`GetSuppliers()`方法及其国家/地区参数时`null`并调用 DAL 的`GetSuppliersByCountry(country)`否则为方法。</span><span class="sxs-lookup"><span data-stu-id="71b6a-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `null` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="71b6a-185">这会返回指定任何国家/地区的所有供应商和供应商提供的适当的子集，包括国家/地区参数时的效果。</span><span class="sxs-lookup"><span data-stu-id="71b6a-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="71b6a-186">更改`GetSuppliersByCountry(country)`中的方法`SuppliersBLL`类所示：</span><span class="sxs-lookup"><span data-stu-id="71b6a-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-csharp[Main](declarative-parameters-cs/samples/sample4.cs)]

<span data-ttu-id="71b6a-187">进行此更改后`DeclarativeParams.aspx`页面将显示所有供应商提供第一次访问时的 (或每当`CountryName`文本框为空)。</span><span class="sxs-lookup"><span data-stu-id="71b6a-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>


<span data-ttu-id="71b6a-188">[![所有供应商是现在默认情况下显示](declarative-parameters-cs/_static/image29.png)](declarative-parameters-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="71b6a-188">[![All Suppliers are Now Shown by Default](declarative-parameters-cs/_static/image29.png)](declarative-parameters-cs/_static/image28.png)</span></span>

<span data-ttu-id="71b6a-189">**图 10**： 所有供应商是现在默认情况下显示 ([单击以查看实际尺寸的图像](declarative-parameters-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="71b6a-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-cs/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="71b6a-190">总结</span><span class="sxs-lookup"><span data-stu-id="71b6a-190">Summary</span></span>

<span data-ttu-id="71b6a-191">若要使用的输入参数使用方法，我们需要在 ObjectDataSource 的指定参数的值`SelectParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="71b6a-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="71b6a-192">不同类型的参数允许从不同的源获得参数值。</span><span class="sxs-lookup"><span data-stu-id="71b6a-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="71b6a-193">默认参数类型使用硬编码的值，但正如轻松 （和无需编写一行代码） 可以从查询字符串、 会话变量、 cookie 和页上的 Web 控件中甚至用户输入的值获取参数值。</span><span class="sxs-lookup"><span data-stu-id="71b6a-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="71b6a-194">在本教程中介绍了我们的示例阐释了如何使用声明性参数值。</span><span class="sxs-lookup"><span data-stu-id="71b6a-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="71b6a-195">但是，可能会我们需要使用参数源不可用，例如当前日期和时间，或者，如果我们的站点使用的成员资格，访问者的用户 ID。</span><span class="sxs-lookup"><span data-stu-id="71b6a-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="71b6a-196">对于这种情况下我们可以设置参数值以编程方式在 ObjectDataSource 之前调用其基础对象的方法。</span><span class="sxs-lookup"><span data-stu-id="71b6a-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="71b6a-197">我们将了解如何实现此目标[下一教程](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)。</span><span class="sxs-lookup"><span data-stu-id="71b6a-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md).</span></span>

<span data-ttu-id="71b6a-198">快乐编程 ！</span><span class="sxs-lookup"><span data-stu-id="71b6a-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="71b6a-199">关于作者</span><span class="sxs-lookup"><span data-stu-id="71b6a-199">About the Author</span></span>

<span data-ttu-id="71b6a-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)的七个部 asp/ASP.NET 书籍并创办了作者[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年以来一直致力于 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="71b6a-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="71b6a-201">Scott 是独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="71b6a-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="71b6a-202">他最新著作是[ *Sams Teach 自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="71b6a-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="71b6a-203">他可以到达[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="71b6a-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="71b6a-204">或通过他的博客，其中，请参阅[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="71b6a-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="71b6a-205">特别感谢</span><span class="sxs-lookup"><span data-stu-id="71b6a-205">Special Thanks To</span></span>

<span data-ttu-id="71b6a-206">很多有用的审阅者已评审本系列教程。</span><span class="sxs-lookup"><span data-stu-id="71b6a-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="71b6a-207">本教程中的潜在顾客审阅者是 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="71b6a-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="71b6a-208">是否有兴趣查看我即将推出的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="71b6a-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="71b6a-209">如果是这样，给我在行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="71b6a-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="71b6a-210">[上一页](displaying-data-with-the-objectdatasource-cs.md)
> [下一页](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)</span><span class="sxs-lookup"><span data-stu-id="71b6a-210">[Previous](displaying-data-with-the-objectdatasource-cs.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)</span></span>
