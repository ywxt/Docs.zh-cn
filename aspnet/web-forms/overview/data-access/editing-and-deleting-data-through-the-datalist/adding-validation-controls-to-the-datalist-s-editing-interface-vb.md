---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
title: 将验证控件添加到 DataList 的编辑界面 (VB) |Microsoft Docs
author: rick-anderson
description: 在本教程中我们将了解如何轻松将验证控件添加到 DataList 的 EditItemTemplate，以提供更能做到万无一失编辑用户 int。...
ms.author: aspnetcontent
ms.date: 10/30/2006
ms.assetid: 6b073fc6-524d-453d-be7c-0c30986de391
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 6f7df844462b016ed74430db782005931562fda5
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/05/2018
ms.locfileid: "37833567"
---
<a name="adding-validation-controls-to-the-datalists-editing-interface-vb"></a><span data-ttu-id="1cb39-103">向 DataList 的编辑界面 (VB) 中添加验证控件</span><span class="sxs-lookup"><span data-stu-id="1cb39-103">Adding Validation Controls to the DataList's Editing Interface (VB)</span></span>
====================
<span data-ttu-id="1cb39-104">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1cb39-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1cb39-105">[下载示例应用程序](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe)或[下载 PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1cb39-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe) or [Download PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span></span>

> <span data-ttu-id="1cb39-106">在本教程中我们将看到将验证控件添加到 DataList 的 EditItemTemplate，以提供更能做到万无一失编辑的用户界面是多么容易。</span><span class="sxs-lookup"><span data-stu-id="1cb39-106">In this tutorial we'll see how easy it is to add validation controls to the DataList's EditItemTemplate in order to provide a more foolproof editing user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="1cb39-107">介绍</span><span class="sxs-lookup"><span data-stu-id="1cb39-107">Introduction</span></span>

<span data-ttu-id="1cb39-108">DataList 编辑教程到目前为止，在编辑接口 DataLists 具有不包含任何主动用户输入的验证，即使无效的用户输入如缺少的产品名称或负的价格会引发异常。</span><span class="sxs-lookup"><span data-stu-id="1cb39-108">In the DataList editing tutorials thus far, the DataLists editing interfaces have not included any proactive user input validation even though invalid user input such as a missing product name or negative price results in an exception.</span></span> <span data-ttu-id="1cb39-109">在中[前面的教程](handling-bll-and-dal-level-exceptions-vb.md)介绍了如何添加异常处理代码，DataList 的`UpdateCommand`事件处理程序以捕获并适当地显示有关已引发任何异常的信息。</span><span class="sxs-lookup"><span data-stu-id="1cb39-109">In the [preceding tutorial](handling-bll-and-dal-level-exceptions-vb.md) we examined how to add exception handling code to the DataList s `UpdateCommand` event handler in order to catch and gracefully display information about any exceptions that were raised.</span></span> <span data-ttu-id="1cb39-110">但是，理想情况下，编辑界面将包括验证控件，以阻止用户从第一个位置中输入此类无效数据。</span><span class="sxs-lookup"><span data-stu-id="1cb39-110">Ideally, however, the editing interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="1cb39-111">在本教程中我们将看到验证控件添加到 DataList s 是多么`EditItemTemplate`为了提供更能做到万无一失编辑的用户界面。</span><span class="sxs-lookup"><span data-stu-id="1cb39-111">In this tutorial we'll see how easy it is to add validation controls to the DataList s `EditItemTemplate` in order to provide a more foolproof editing user interface.</span></span> <span data-ttu-id="1cb39-112">具体而言，本教程采用前面教程中创建的示例，并补充了编辑界面包括适当的验证。</span><span class="sxs-lookup"><span data-stu-id="1cb39-112">Specifically, this tutorial takes the example created in the preceding tutorial and augments the editing interface to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromhandling-bll--and-dal-level-exceptionshandling-bll-and-dal-level-exceptions-vbmd"></a><span data-ttu-id="1cb39-113">步骤 1： 复制中的示例[处理 BLL 和 DAL 级别的异常](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1cb39-113">Step 1: Replicating the Example from[Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md)</span></span>

<span data-ttu-id="1cb39-114">在中[处理 BLL-和 DAL 级别的异常](handling-bll-and-dal-level-exceptions-vb.md)教程中，我们创建所列的名称和两个列中，可编辑 DataList 中的产品价格的页面。</span><span class="sxs-lookup"><span data-stu-id="1cb39-114">In the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial we created a page that listed the names and prices of the products in a two-column, editable DataList.</span></span> <span data-ttu-id="1cb39-115">对于本教程旨在扩充 DataList s 编辑界面，包括验证控件。</span><span class="sxs-lookup"><span data-stu-id="1cb39-115">Our goal for this tutorial is to augment the DataList s editing interface to include validation controls.</span></span> <span data-ttu-id="1cb39-116">具体而言，我们验证逻辑将：</span><span class="sxs-lookup"><span data-stu-id="1cb39-116">In particular, our validation logic will:</span></span>

- <span data-ttu-id="1cb39-117">要求提供产品的名称</span><span class="sxs-lookup"><span data-stu-id="1cb39-117">Require that the product s name be provided</span></span>
- <span data-ttu-id="1cb39-118">请确保输入的价格的值是一种有效的货币格式</span><span class="sxs-lookup"><span data-stu-id="1cb39-118">Ensure that the value entered for the price is a valid currency format</span></span>
- <span data-ttu-id="1cb39-119">确保输入的价格是大于或等于零，因为负的值`UnitPrice`值是非法的</span><span class="sxs-lookup"><span data-stu-id="1cb39-119">Ensure that the value entered for the price is greater than or equal to zero, since a negative `UnitPrice` value is illegal</span></span>

<span data-ttu-id="1cb39-120">我们可以看看扩充一示例，包括验证之前，我们首先需要复制中的示例`ErrorHandling.aspx`页中`EditDeleteDataList`用于本教程中，逐页文件夹`UIValidation.aspx`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-120">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="1cb39-121">若要实现此，我们需要通过同时复制`ErrorHandling.aspx`页面 s 声明性标记和其源代码。</span><span class="sxs-lookup"><span data-stu-id="1cb39-121">To achieve this we need to copy over both the `ErrorHandling.aspx` page s declarative markup and its source code.</span></span> <span data-ttu-id="1cb39-122">将复制的声明性标记，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="1cb39-122">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="1cb39-123">打开`ErrorHandling.aspx`Visual Studio 中的页</span><span class="sxs-lookup"><span data-stu-id="1cb39-123">Open the `ErrorHandling.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="1cb39-124">请转到页面 s 声明性标记 （在页面底部的源按钮单击）</span><span class="sxs-lookup"><span data-stu-id="1cb39-124">Go to the page s declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="1cb39-125">复制中的文本`<asp:Content>`和`</asp:Content>`标记 （行 3 到 32），作为图 1 所示。</span><span class="sxs-lookup"><span data-stu-id="1cb39-125">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 32), as shown in Figure 1.</span></span>


<span data-ttu-id="1cb39-126">[![复制文本内&lt;asp: Content&gt;控件](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1cb39-126">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="1cb39-127">**图 2**： 复制文本内`<asp:Content>`控件 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="1cb39-127">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>


1. <span data-ttu-id="1cb39-128">打开`UIValidation.aspx`页</span><span class="sxs-lookup"><span data-stu-id="1cb39-128">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="1cb39-129">请转到页面 s 声明性标记</span><span class="sxs-lookup"><span data-stu-id="1cb39-129">Go to the page s declarative markup</span></span>
3. <span data-ttu-id="1cb39-130">中的文本将粘贴`<asp:Content>`控件。</span><span class="sxs-lookup"><span data-stu-id="1cb39-130">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="1cb39-131">若要复制的源代码，请打开`ErrorHandling.aspx.vb`页上，并将复制只是文本*内*`EditDeleteDataList_ErrorHandling`类。</span><span class="sxs-lookup"><span data-stu-id="1cb39-131">To copy over the source code, open the `ErrorHandling.aspx.vb` page and copy just the text *within* the `EditDeleteDataList_ErrorHandling` class.</span></span> <span data-ttu-id="1cb39-132">将复制的三个事件处理程序 (`Products_EditCommand`， `Products_CancelCommand`，并`Products_UpdateCommand`) 连同`DisplayExceptionDetails`方法，但**不**复制类声明或`using`语句。</span><span class="sxs-lookup"><span data-stu-id="1cb39-132">Copy the three event handlers (`Products_EditCommand`, `Products_CancelCommand`, and `Products_UpdateCommand`) along with the `DisplayExceptionDetails` method, but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="1cb39-133">粘贴复制的文本*内*`EditDeleteDataList_UIValidation`类中`UIValidation.aspx.vb`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-133">Paste the copied text *within* the `EditDeleteDataList_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="1cb39-134">移动的内容和从代码转移后`ErrorHandling.aspx`到`UIValidation.aspx`，花点时间来测试在浏览器中的页。</span><span class="sxs-lookup"><span data-stu-id="1cb39-134">After moving over the content and code from `ErrorHandling.aspx` to `UIValidation.aspx`, take a moment to test out the pages in a browser.</span></span> <span data-ttu-id="1cb39-135">你应看到相同的输出和体验每个 （请参见图 2） 这些两个页中相同的功能。</span><span class="sxs-lookup"><span data-stu-id="1cb39-135">You should see the same output and experience the same functionality in each of these two pages (see Figure 2).</span></span>


<span data-ttu-id="1cb39-136">[![UIValidation.aspx 页模仿 ErrorHandling.aspx 中的功能](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="1cb39-136">[![The UIValidation.aspx Page Mimics the Functionality in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="1cb39-137">**图 2**:`UIValidation.aspx`页上模拟中的功能`ErrorHandling.aspx`([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="1cb39-137">**Figure 2**: The `UIValidation.aspx` Page Mimics the Functionality in `ErrorHandling.aspx` ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-adding-the-validation-controls-to-the-datalist-s-edititemtemplate"></a><span data-ttu-id="1cb39-138">步骤 2： 向 DataList 的 EditItemTemplate 添加验证控件</span><span class="sxs-lookup"><span data-stu-id="1cb39-138">Step 2: Adding the Validation Controls to the DataList s EditItemTemplate</span></span>

<span data-ttu-id="1cb39-139">在构造时数据输入窗体，务必用户输入所有必填的字段和所有其提供的输入是合法的格式正确的值。</span><span class="sxs-lookup"><span data-stu-id="1cb39-139">When constructing data entry forms, it is important that users enter any required fields and that all their provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="1cb39-140">为了帮助确保用户的输入有效，ASP.NET 提供了五个内置的验证控件的设计来验证单个输入 Web 控件的值：</span><span class="sxs-lookup"><span data-stu-id="1cb39-140">To help ensure that a user s inputs are valid, ASP.NET provides five built-in validation controls that are designed to validate the value of a single input Web control:</span></span>

- <span data-ttu-id="1cb39-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)可确保已提供一个值</span><span class="sxs-lookup"><span data-stu-id="1cb39-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="1cb39-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)验证值与另一个 Web 控件值或常量的值，或确保值的格式是合法的指定的数据类型</span><span class="sxs-lookup"><span data-stu-id="1cb39-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value s format is legal for a specified data type</span></span>
- <span data-ttu-id="1cb39-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)可确保一个值，值范围内</span><span class="sxs-lookup"><span data-stu-id="1cb39-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="1cb39-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx)来验证针对值[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="1cb39-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="1cb39-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)验证值与自定义、 用户定义方法</span><span class="sxs-lookup"><span data-stu-id="1cb39-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="1cb39-146">有关这些五个控件的详细信息请参阅重新[向编辑和插入界面添加验证控件](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)教程或签出[验证控件部分](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx)的[ASP.NET 快速入门教程](https://quickstarts.asp.net)。</span><span class="sxs-lookup"><span data-stu-id="1cb39-146">For more information on these five controls refer back to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial or check out the [Validation Controls section](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://quickstarts.asp.net).</span></span>

<span data-ttu-id="1cb39-147">本教程中我们将需要使用一个 RequiredFieldValidator 以确保已提供的产品名称的值和 CompareValidator 以确保输入的价格的值大于或等于 0，并以有效的货币格式显示。</span><span class="sxs-lookup"><span data-stu-id="1cb39-147">For our tutorial we'll need to use a RequiredFieldValidator to ensure that a value for the product name has been supplied and a CompareValidator to ensure that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="1cb39-148">尽管 ASP.NET 1.x 有这些相同的五个验证控件、 ASP.NET 2.0 增添了大量改进，两人是客户端脚本包括 Internet Explorer 的浏览器和分区到页面上的验证控件的功能支持的主要验证组。</span><span class="sxs-lookup"><span data-stu-id="1cb39-148">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers in addition to Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="1cb39-149">有关 2.0 中新的验证控件功能的详细信息，请参阅[仔细分析 ASP.NET 2.0 中的验证控件](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="1cb39-149">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>


<span data-ttu-id="1cb39-150">让我们来首先将必要的验证控件添加到 DataList 的`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-150">Let s start by adding the necessary validation controls to the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="1cb39-151">通过单击编辑模板链接通过 DataList s 智能标记，在设计器或通过声明性语法，可以执行此任务。</span><span class="sxs-lookup"><span data-stu-id="1cb39-151">This task can be performed through the Designer by clicking on the Edit Templates link from the DataList s smart tag, or through the declarative syntax.</span></span> <span data-ttu-id="1cb39-152">允许 s 步骤通过使用设计视图中的编辑模板选项的过程。</span><span class="sxs-lookup"><span data-stu-id="1cb39-152">Let s step through the process using the Edit Templates option from the Design view.</span></span> <span data-ttu-id="1cb39-153">在选择要编辑 DataList s 之后`EditItemTemplate`，通过从工具箱拖动到模板编辑界面中，添加一个 RequiredFieldValidator 将其之后放置`ProductName`文本框中。</span><span class="sxs-lookup"><span data-stu-id="1cb39-153">After choosing to edit the DataList s `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing it after the `ProductName` TextBox.</span></span>


<span data-ttu-id="1cb39-154">[![在产品名称文本框之后向 EditItemTemplate 添加一个 RequiredFieldValidator](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1cb39-154">[![Add a RequiredFieldValidator to the EditItemTemplate After the ProductName TextBox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="1cb39-155">**图 3**： 添加到一个 RequiredFieldValidator `EditItemTemplate After` `ProductName`文本框中 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="1cb39-155">**Figure 3**: Add a RequiredFieldValidator to the `EditItemTemplate After` the `ProductName` TextBox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>


<span data-ttu-id="1cb39-156">通过验证单个 ASP.NET Web 控件的输入处理的所有验证控件。</span><span class="sxs-lookup"><span data-stu-id="1cb39-156">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="1cb39-157">因此，我们需要指示应验证我们刚添加的 RequiredFieldValidator`ProductName`文本框中; 这是通过设置验证控件 s [ `ControlToValidate`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)到`ID`的相应的 Web 控件 (`ProductName`，在这种情况)。</span><span class="sxs-lookup"><span data-stu-id="1cb39-157">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the `ProductName` TextBox; this is done by setting the validation control s [`ControlToValidate` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control (`ProductName`, in this instance).</span></span> <span data-ttu-id="1cb39-158">接下来，设置[`ErrorMessage`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)必须为提供的产品的名称并[`Text`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)到\*。</span><span class="sxs-lookup"><span data-stu-id="1cb39-158">Next, set the [`ErrorMessage` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to You must provide the product s name and the [`Text` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to \*.</span></span> <span data-ttu-id="1cb39-159">`Text`属性值，如果提供，则如果验证失败的验证控件显示的文本。</span><span class="sxs-lookup"><span data-stu-id="1cb39-159">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="1cb39-160">`ErrorMessage`属性值，该值是必需的由 ValidationSummary 控件; 如果`Text`省略属性值，则`ErrorMessage`属性值显示由验证控件在输入无效。</span><span class="sxs-lookup"><span data-stu-id="1cb39-160">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="1cb39-161">以后设置 RequiredFieldValidator 这三个属性，您的屏幕看起来应类似于图 4。</span><span class="sxs-lookup"><span data-stu-id="1cb39-161">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 4.</span></span>


<span data-ttu-id="1cb39-162">[![设置 RequiredFieldValidator 的 ControlToValidate、 错误消息和文本属性](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="1cb39-162">[![Set the RequiredFieldValidator s ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="1cb39-163">**图 4**： 设置 RequiredFieldValidator s `ControlToValidate`， `ErrorMessage`，和`Text`属性 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="1cb39-163">**Figure 4**: Set the RequiredFieldValidator s `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>


<span data-ttu-id="1cb39-164">使用添加到 RequiredFieldValidator `EditItemTemplate`，则所有剩下是有必要为添加验证产品的价格文本框中。</span><span class="sxs-lookup"><span data-stu-id="1cb39-164">With the RequiredFieldValidator added to the `EditItemTemplate`, all that remains is to add the necessary validation for the product s price TextBox.</span></span> <span data-ttu-id="1cb39-165">由于`UnitPrice`取决于您在编辑记录时，我们不需要添加一个 RequiredFieldValidator。</span><span class="sxs-lookup"><span data-stu-id="1cb39-165">Since the `UnitPrice` is optional when editing a record, we don t need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="1cb39-166">我们执行操作，但是，需要添加 CompareValidator，确保`UnitPrice`，如果提供，作为一种货币格式正确，大于或等于 0。</span><span class="sxs-lookup"><span data-stu-id="1cb39-166">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="1cb39-167">添加到 CompareValidator`EditItemTemplate`并设置其`ControlToValidate`属性设置为`UnitPrice`，将其`ErrorMessage`属性设置为价格必须大于或等于零，并且不能包括货币符号，并将其`Text`属性\*.</span><span class="sxs-lookup"><span data-stu-id="1cb39-167">Add the CompareValidator into the `EditItemTemplate` and set its `ControlToValidate` property to `UnitPrice`, its `ErrorMessage` property to The price must be greater than or equal to zero and cannot include the currency symbol, and its `Text` property to \*.</span></span> <span data-ttu-id="1cb39-168">若要指示`UnitPrice`值必须是大于或等于 0，设置 CompareValidator s [ `Operator`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)到`GreaterThanEqual`，将其[`ValueToCompare`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)为 0，并其[`Type`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)到`Currency`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-168">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator s [`Operator` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [`ValueToCompare` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to 0, and its [`Type` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span>

<span data-ttu-id="1cb39-169">之后添加以下两个验证控件，DataList 的`EditItemTemplate`s 声明性语法应看起来如下所示：</span><span class="sxs-lookup"><span data-stu-id="1cb39-169">After adding these two validation controls, the DataList s `EditItemTemplate` s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="1cb39-170">进行这些更改后，在浏览器中打开的网页。</span><span class="sxs-lookup"><span data-stu-id="1cb39-170">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="1cb39-171">如果尝试省略名称或编辑产品时输入无效的价格值文本框旁边将出现一个星号。</span><span class="sxs-lookup"><span data-stu-id="1cb39-171">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="1cb39-172">如图 5 所示，包含货币符号，例如 19.95 美元的价格值将被视为无效。</span><span class="sxs-lookup"><span data-stu-id="1cb39-172">As Figure 5 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="1cb39-173">CompareValidator s `Currency` `Type`允许数字分隔符 （如逗号或句点，具体取决于的区域性设置） 和前导加号或减号，但不*不*允许货币符号。</span><span class="sxs-lookup"><span data-stu-id="1cb39-173">The CompareValidator s `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="1cb39-174">此行为可能 perplex 用户编辑界面当前呈现`UnitPrice`使用货币格式。</span><span class="sxs-lookup"><span data-stu-id="1cb39-174">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>


<span data-ttu-id="1cb39-175">[![使用无效的输入文本框旁边会显示一个星号](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="1cb39-175">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="1cb39-176">**图 5**: 星号显示下一步使用无效的输入文本框 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="1cb39-176">**Figure 5**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>


<span data-ttu-id="1cb39-177">尽管验证可充当的是，用户必须手动编辑一个记录，这不是可接受时删除的货币符号。</span><span class="sxs-lookup"><span data-stu-id="1cb39-177">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="1cb39-178">此外，如果有无效输入中的编辑的接口都不更新，也不取消按钮，当单击时，将调用回发。</span><span class="sxs-lookup"><span data-stu-id="1cb39-178">Moreover, if there are invalid inputs in the editing interface neither the Update nor Cancel buttons, when clicked, will invoke a postback.</span></span> <span data-ttu-id="1cb39-179">理想情况下，取消按钮将为其预编辑而不考虑用户的输入数据的有效性状态返回 DataList。</span><span class="sxs-lookup"><span data-stu-id="1cb39-179">Ideally, the Cancel button would return the DataList to its pre-editing state regardless of the validity of the user s inputs.</span></span> <span data-ttu-id="1cb39-180">此外，我们需要确保更新 DataList s 中的产品信息之前，s 的页面数据是有效`UpdateCommand`事件处理程序，作为其浏览器不支持 JavaScript 或具有的用户可以跳过客户端逻辑的验证控件禁用其支持。</span><span class="sxs-lookup"><span data-stu-id="1cb39-180">Also, we need to ensure that the page s data is valid before updating the product information in the DataList s `UpdateCommand` event handler, as the validation controls client-side logic can be bypassed by users whose browsers either don t support JavaScript or have its support disabled.</span></span>

## <a name="removing-the-currency-symbol-from-the-edititemtemplate-s-unitprice-textbox"></a><span data-ttu-id="1cb39-181">从 EditItemTemplate s 单价文本框中删除的货币符号</span><span class="sxs-lookup"><span data-stu-id="1cb39-181">Removing the Currency Symbol from the EditItemTemplate s UnitPrice TextBox</span></span>

<span data-ttu-id="1cb39-182">当使用 CompareValidator 的`Currency``Type`，所验证的输入不能包含任何货币符号。</span><span class="sxs-lookup"><span data-stu-id="1cb39-182">When using the CompareValidator s `Currency``Type`, the input being validated must not include any currency symbols.</span></span> <span data-ttu-id="1cb39-183">此类符号存在导致 CompareValidator 将标记为无效的输入。</span><span class="sxs-lookup"><span data-stu-id="1cb39-183">The presence of such symbols causes the CompareValidator to mark the input as invalid.</span></span> <span data-ttu-id="1cb39-184">但是，我们的编辑界面当前包括中的货币符号`UnitPrice`文本框中，这意味着用户必须显式保存其更改前删除的货币符号。</span><span class="sxs-lookup"><span data-stu-id="1cb39-184">However, our editing interface currently includes a currency symbol in the `UnitPrice` TextBox, meaning the user must explicitly remove the currency symbol before saving their changes.</span></span> <span data-ttu-id="1cb39-185">若要解决此问题，我们有三个选项：</span><span class="sxs-lookup"><span data-stu-id="1cb39-185">To remedy this we have three options:</span></span>

1. <span data-ttu-id="1cb39-186">配置`EditItemTemplate`，以便`UnitPrice`文本框值未格式化为货币。</span><span class="sxs-lookup"><span data-stu-id="1cb39-186">Configure the `EditItemTemplate` so that the `UnitPrice` TextBox value is not formatted as a currency.</span></span>
2. <span data-ttu-id="1cb39-187">允许用户通过删除 CompareValidator 并将它替换为正确格式的货币值检查 RegularExpressionValidator 输入货币符号。</span><span class="sxs-lookup"><span data-stu-id="1cb39-187">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that checks for a properly formatted currency value.</span></span> <span data-ttu-id="1cb39-188">此处的挑战就是要验证的货币值的正则表达式不是像简单 CompareValidator，如果我们想要合并的区域性设置则需要编写代码。</span><span class="sxs-lookup"><span data-stu-id="1cb39-188">The challenge here is that the regular expression to validate a currency value is not as straightforward as the CompareValidator and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="1cb39-189">完全删除的验证控件和 GridView s 中的自定义服务器端验证逻辑依赖于`RowUpdating`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="1cb39-189">Remove the validation control altogether and rely on custom server-side validation logic in the GridView s `RowUpdating` event handler.</span></span>

<span data-ttu-id="1cb39-190">让我们来使用本教程中的选项 1。</span><span class="sxs-lookup"><span data-stu-id="1cb39-190">Let s go with option 1 for this tutorial.</span></span> <span data-ttu-id="1cb39-191">目前`UnitPrice`格式化为货币值的文本框中的数据绑定表达式由于`EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-191">Currently the `UnitPrice` is formatted as a currency value due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="1cb39-192">更改`Eval`语句`Eval("UnitPrice", "{0:n2}")`，其中将结果格式化为带两位数字的精度的数字。</span><span class="sxs-lookup"><span data-stu-id="1cb39-192">Change the `Eval` statement to `Eval("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="1cb39-193">这可以通过声明性语法直接或通过单击从编辑 DataBindings 链接`UnitPrice`DataList s 中的文本框`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-193">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `UnitPrice` TextBox in the DataList s `EditItemTemplate`.</span></span>

<span data-ttu-id="1cb39-194">进行此更改后，编辑界面中的格式化的价格包含组分隔符为逗号和句点作为小数分隔符，但哪儿货币符号。</span><span class="sxs-lookup"><span data-stu-id="1cb39-194">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="1cb39-195">删除时的货币格式从可编辑的接口，我发现有助于将作为外部文本框的文本放在货币符号。</span><span class="sxs-lookup"><span data-stu-id="1cb39-195">When removing the currency format from the editable interface, I find it helpful to put the currency symbol as text outside the TextBox.</span></span> <span data-ttu-id="1cb39-196">这将作为对它们不需要提供的货币符号的用户的提示。</span><span class="sxs-lookup"><span data-stu-id="1cb39-196">This serves as a hint to the user that they do not need to provide the currency symbol.</span></span>


## <a name="fixing-the-cancel-button"></a><span data-ttu-id="1cb39-197">修复取消按钮</span><span class="sxs-lookup"><span data-stu-id="1cb39-197">Fixing the Cancel Button</span></span>

<span data-ttu-id="1cb39-198">默认情况下，验证 Web 控件发出 JavaScript 客户端上执行验证。</span><span class="sxs-lookup"><span data-stu-id="1cb39-198">By default, the validation Web controls emit JavaScript to perform validation on the client-side.</span></span> <span data-ttu-id="1cb39-199">单击按钮、 LinkButton 或 ImageButton 时，发生回发之前，要在客户端检查的页上的验证控件。</span><span class="sxs-lookup"><span data-stu-id="1cb39-199">When a Button, LinkButton, or ImageButton is clicked, the validation controls on the page are checked on the client-side before the postback occurs.</span></span> <span data-ttu-id="1cb39-200">如果没有任何无效的数据，则取消回发。</span><span class="sxs-lookup"><span data-stu-id="1cb39-200">If there is any invalid data, the postback is cancelled.</span></span> <span data-ttu-id="1cb39-201">对于某些按钮，不过，这些数据的有效性可能无关紧要;在这种情况下，由于数据无效而取消在回发是麻烦。</span><span class="sxs-lookup"><span data-stu-id="1cb39-201">For certain Buttons, though, the validity of the data might be immaterial; in such a case, having the postback cancelled due to invalid data is a nuisance.</span></span>

<span data-ttu-id="1cb39-202">取消按钮是此类示例。</span><span class="sxs-lookup"><span data-stu-id="1cb39-202">The Cancel button is such an example.</span></span> <span data-ttu-id="1cb39-203">假设用户输入无效数据，例如省略 s 产品名称，，，然后决定她没有 t 要保存该产品毕竟并点击取消按钮。</span><span class="sxs-lookup"><span data-stu-id="1cb39-203">Imagine that a user enters invalid data, such as omitting the product s name, and then decides she doesn t want to save the product after all and hits the Cancel button.</span></span> <span data-ttu-id="1cb39-204">目前，取消按钮触发验证控件的页上，该报告的产品名称缺失，并防止在回发。</span><span class="sxs-lookup"><span data-stu-id="1cb39-204">Currently, the Cancel button triggers the validation controls on the page, which report that the product name is missing and prevent the postback.</span></span> <span data-ttu-id="1cb39-205">我们的用户必须键入一些文本`ProductName`文本框只是为了取消编辑过程。</span><span class="sxs-lookup"><span data-stu-id="1cb39-205">Our user has to type some text into the `ProductName` TextBox just to cancel out of the editing process.</span></span>

<span data-ttu-id="1cb39-206">幸运的是，具有按钮、 LinkButton 和 ImageButton [ `CausesValidation`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx)，可以指示是否单击该按钮应启动的验证逻辑 (默认为`True`)。</span><span class="sxs-lookup"><span data-stu-id="1cb39-206">Fortunately, the Button, LinkButton, and ImageButton have a [`CausesValidation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) that can indicate whether or not clicking the Button should initiate the validation logic (defaults to `True`).</span></span> <span data-ttu-id="1cb39-207">设置的取消按钮 s`CausesValidation`属性设置为`False`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-207">Set the Cancel Button s `CausesValidation` property to `False`.</span></span>

## <a name="ensuring-the-inputs-are-valid-in-the-updatecommand-event-handler"></a><span data-ttu-id="1cb39-208">确保输入是在 UpdateCommand 事件处理程序中有效</span><span class="sxs-lookup"><span data-stu-id="1cb39-208">Ensuring the Inputs are Valid in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="1cb39-209">由于客户端脚本发出的验证控件中，如果用户输入无效的输入验证控件取消按钮，LinkButton，由启动任何回发或 ImageButton 控件`CausesValidation`属性是`True`(默认值）。</span><span class="sxs-lookup"><span data-stu-id="1cb39-209">Due to the client-side script emitted by the validation controls, if a user enters invalid input the validation controls cancel any postbacks initiated by Button, LinkButton, or ImageButton controls whose `CausesValidation` properties are `True` (the default).</span></span> <span data-ttu-id="1cb39-210">但是，如果用户访问弃用了早已过时浏览器或从一台支持其 JavaScript 已被禁用，不会执行客户端验证检查。</span><span class="sxs-lookup"><span data-stu-id="1cb39-210">However, if a user is visiting with an antiquated browser or one whose JavaScript support has been disabled, the client-side validation checks will not execute.</span></span>

<span data-ttu-id="1cb39-211">ASP.NET 验证控件的所有重复他们立即在回发时的验证逻辑并报告整体通过页面 + s 输入的有效性[`Page.IsValid`属性](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx)。</span><span class="sxs-lookup"><span data-stu-id="1cb39-211">All of the ASP.NET validation controls repeat their validation logic immediately upon postback and report the overall validity of the page s inputs via the [`Page.IsValid` property](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span></span> <span data-ttu-id="1cb39-212">但是，页面流不是中断或停止任何方式基于的值中`Page.IsValid`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-212">However, the page flow is not interrupted or stopped in any way based on the value of `Page.IsValid`.</span></span> <span data-ttu-id="1cb39-213">作为开发人员，它是我们有责任确保`Page.IsValid`属性的值为`True`继续进行假设有效的代码输入数据之前。</span><span class="sxs-lookup"><span data-stu-id="1cb39-213">As developers, it is our responsibility to ensure that the `Page.IsValid` property has a value of `True` before proceeding with code that assumes valid input data.</span></span>

<span data-ttu-id="1cb39-214">如果用户已禁用 JavaScript，访问我们的页面、 编辑产品、 输入过的价格值开销很大，并单击更新按钮，将跳过客户端验证和回发将会随之发生。</span><span class="sxs-lookup"><span data-stu-id="1cb39-214">If a user has JavaScript disabled, visits our page, edits a product, enters a price value of Too expensive, and clicks the Update button, the client-side validation will be bypassed and a postback will ensue.</span></span> <span data-ttu-id="1cb39-215">在回发时，ASP.NET 页面 + s`UpdateCommand`事件处理程序执行，并引发异常时尝试分析过代价高昂的`Decimal`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-215">On postback, the ASP.NET page s `UpdateCommand` event handler executes and an exception is raised when attempting to parse Too expensive to a `Decimal`.</span></span> <span data-ttu-id="1cb39-216">由于我们具有异常处理，此类异常将正常处理，但我们无法防止无效的数据通过第一个位置中仅使用继续操作落后`UpdateCommand`事件处理程序如果`Page.IsValid`的值为`True`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-216">Since we have exception handling, such an exception will be handled gracefully, but we could prevent the invalid data from slipping through in the first place by only proceeding with the `UpdateCommand` event handler if `Page.IsValid` has a value of `True`.</span></span>

<span data-ttu-id="1cb39-217">将以下代码添加到开头`UpdateCommand`事件处理程序之前`Try`块：</span><span class="sxs-lookup"><span data-stu-id="1cb39-217">Add the following code to the start of the `UpdateCommand` event handler, immediately before the `Try` block:</span></span>


[!code-vb[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample2.vb)]

<span data-ttu-id="1cb39-218">添加此元素，该产品将尝试提交的数据是有效时才进行更新。</span><span class="sxs-lookup"><span data-stu-id="1cb39-218">With this addition, the product will attempt to be updated only if the submitted data is valid.</span></span> <span data-ttu-id="1cb39-219">大多数用户结束-赢得 t 能够回发无效数据，因为验证控件客户端脚本，但其浏览器不支持 JavaScript 或具有支持的 JavaScript 的用户禁用，可以跳过客户端检查和提交无效数据。</span><span class="sxs-lookup"><span data-stu-id="1cb39-219">Most users won t be able to postback invalid data due to the validation controls client-side scripts, but users whose browsers don t support JavaScript or that have JavaScript support disabled, can bypass the client-side checks and submit invalid data.</span></span>

> [!NOTE]
> <span data-ttu-id="1cb39-220">敏锐的读者的 GridView 中，更新数据时将会记得，我们并没有无需显式检查`Page.IsValid`我们页的代码隐藏类中的属性。</span><span class="sxs-lookup"><span data-stu-id="1cb39-220">The astute reader will recall that when updating data with the GridView, we didn t need to explicitly check the `Page.IsValid` property in our page s code-behind class.</span></span> <span data-ttu-id="1cb39-221">这是因为 GridView 咨询`Page.IsValid`我们和仅继续进行更新，仅当返回的值的属性`True`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-221">This is because the GridView consults the `Page.IsValid` property for us and only proceeds with the update only if it returns a value of `True`.</span></span>


## <a name="step-3-summarizing-data-entry-problems"></a><span data-ttu-id="1cb39-222">步骤 3： 汇总数据输入问题</span><span class="sxs-lookup"><span data-stu-id="1cb39-222">Step 3: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="1cb39-223">ASP.NET 包括五个验证控件中，除了[ValidationSummary 控件](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)，其中显示`ErrorMessage`s 检测到无效数据这些验证控件。</span><span class="sxs-lookup"><span data-stu-id="1cb39-223">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="1cb39-224">此摘要数据可以显示为文本在网页上或通过模式、 客户端的消息框。</span><span class="sxs-lookup"><span data-stu-id="1cb39-224">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="1cb39-225">让我们来增强此教程，包括汇总的任何验证问题的客户端的 messagebox。</span><span class="sxs-lookup"><span data-stu-id="1cb39-225">Let s enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="1cb39-226">若要实现此目的，请从工具箱拖到设计器拖动 ValidationSummary 控件。</span><span class="sxs-lookup"><span data-stu-id="1cb39-226">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="1cb39-227">ValidationSummary 控件不是 t 的位置非常重要，因为我们重新将它配置为仅显示为一个消息框的摘要。</span><span class="sxs-lookup"><span data-stu-id="1cb39-227">The location of the ValidationSummary control doesn t really matter, since we re going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="1cb39-228">添加控件之后, 设置其[`ShowSummary`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)到`False`并将其[`ShowMessageBox`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)到`True`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-228">After adding the control, set its [`ShowSummary` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [`ShowMessageBox` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="1cb39-229">添加此元素后，任何验证错误汇总客户端的 messagebox 中 （请参阅图 6）。</span><span class="sxs-lookup"><span data-stu-id="1cb39-229">With this addition, any validation errors are summarized in a client-side messagebox (see Figure 6).</span></span>


<span data-ttu-id="1cb39-230">[![客户端的 Messagebox 中总结了验证错误](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="1cb39-230">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="1cb39-231">**图 6**： 客户端的 Messagebox 中总结了验证错误 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="1cb39-231">**Figure 6**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>


## <a name="summary"></a><span data-ttu-id="1cb39-232">总结</span><span class="sxs-lookup"><span data-stu-id="1cb39-232">Summary</span></span>

<span data-ttu-id="1cb39-233">在本教程中我们已了解如何通过使用验证控件以主动确保尝试更新工作流中使用它们之前，我们的用户输入有效减少异常的可能性。</span><span class="sxs-lookup"><span data-stu-id="1cb39-233">In this tutorial we saw how to reduce the likelihood of exceptions by using validation controls to proactively ensure that our users inputs are valid before attempting to use them in the updating workflow.</span></span> <span data-ttu-id="1cb39-234">ASP.NET 提供了五个验证 Web 控件，可用于检查特定 Web 控件 s 输入，并报告回输入的 s 有效性。</span><span class="sxs-lookup"><span data-stu-id="1cb39-234">ASP.NET provides five validation Web controls that are designed to inspect a particular Web control s input and report back on the input s validity.</span></span> <span data-ttu-id="1cb39-235">在本教程中我们使用这些五个控件的两个 RequiredFieldValidator 和 CompareValidator 来确保提供的产品的名称和价格，必须具有值大于或等于零的货币格式。</span><span class="sxs-lookup"><span data-stu-id="1cb39-235">In this tutorial we used two of those five controls the RequiredFieldValidator and the CompareValidator to ensure that the product s name was supplied and that the price had a currency format with a value greater than or equal to zero.</span></span>

<span data-ttu-id="1cb39-236">向 DataList s 编辑界面添加验证控件非常简单，将其拖到拖动`EditItemTemplate`从工具箱并设置少量的属性。</span><span class="sxs-lookup"><span data-stu-id="1cb39-236">Adding validation controls to the DataList s editing interface is as simple as dragging them onto the `EditItemTemplate` from the Toolbox and setting a handful of properties.</span></span> <span data-ttu-id="1cb39-237">默认情况下，验证控件自动发出客户端验证脚本;它们还提供服务器端验证回发时，存储中的累积结果`Page.IsValid`属性。</span><span class="sxs-lookup"><span data-stu-id="1cb39-237">By default, the validation controls automatically emit client-side validation script; they also provide server-side validation on postback, storing the cumulative result in the `Page.IsValid` property.</span></span> <span data-ttu-id="1cb39-238">若要在单击按钮、 LinkButton 或 ImageButton 时绕过客户端验证，请设置按钮 s`CausesValidation`属性设置为`False`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-238">To bypass the client-side validation when a Button, LinkButton, or ImageButton is clicked, set the button s `CausesValidation` property to `False`.</span></span> <span data-ttu-id="1cb39-239">此外，在与在回发时提交的数据执行任何任务之前，请确保`Page.IsValid`属性返回`True`。</span><span class="sxs-lookup"><span data-stu-id="1cb39-239">Also, before performing any tasks with the data submitted on postback, ensure that the `Page.IsValid` property returns `True`.</span></span>

<span data-ttu-id="1cb39-240">所有编辑教程 DataList 我们 ve 检查到目前为止已经非常简单的编辑接口产品的名称的文本框，另一个用于价格。</span><span class="sxs-lookup"><span data-stu-id="1cb39-240">All of the DataList editing tutorials we ve examined so far have had very simple editing interfaces a TextBox for the product s name and another for the price.</span></span> <span data-ttu-id="1cb39-241">但是，编辑界面，可以包含多种不同的 Web 控件，如 Dropdownlist、 日历、 单选按钮、 复选框，依次类推。</span><span class="sxs-lookup"><span data-stu-id="1cb39-241">The editing interface, however, can contain a mix of different Web controls, such as DropDownLists, Calendars, RadioButtons, CheckBoxes, and so on.</span></span> <span data-ttu-id="1cb39-242">在我们的下一教程中，我们将了解构建一个接口，使用各种 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="1cb39-242">In our next tutorial we'll look at building an interface that uses a variety of Web controls.</span></span>

<span data-ttu-id="1cb39-243">快乐编程 ！</span><span class="sxs-lookup"><span data-stu-id="1cb39-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1cb39-244">关于作者</span><span class="sxs-lookup"><span data-stu-id="1cb39-244">About the Author</span></span>

<span data-ttu-id="1cb39-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)的七个部 asp/ASP.NET 书籍并创办了作者[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年以来一直致力于 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="1cb39-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1cb39-246">Scott 是独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="1cb39-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1cb39-247">他最新著作是[ *Sams Teach 自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="1cb39-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1cb39-248">他可以到达[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1cb39-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1cb39-249">或通过他的博客，其中，请参阅[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="1cb39-249">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1cb39-250">特别感谢</span><span class="sxs-lookup"><span data-stu-id="1cb39-250">Special Thanks To</span></span>

<span data-ttu-id="1cb39-251">很多有用的审阅者已评审本系列教程。</span><span class="sxs-lookup"><span data-stu-id="1cb39-251">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1cb39-252">本教程中的潜在顾客审阅者是 Dennis Patterson、 Ken Pespisa 和 Liz Shulok。</span><span class="sxs-lookup"><span data-stu-id="1cb39-252">Lead reviewers for this tutorial were Dennis Patterson, Ken Pespisa, and Liz Shulok.</span></span> <span data-ttu-id="1cb39-253">是否有兴趣查看我即将推出的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="1cb39-253">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1cb39-254">如果是这样，给我在行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1cb39-254">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1cb39-255">[上一页](handling-bll-and-dal-level-exceptions-vb.md)
> [下一页](customizing-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1cb39-255">[Previous](handling-bll-and-dal-level-exceptions-vb.md)
[Next](customizing-the-datalist-s-editing-interface-vb.md)</span></span>
