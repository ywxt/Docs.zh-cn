---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
title: 排序 DataList 或 Repeater 控件 (C#) 中的数据 |Microsoft Docs
author: rick-anderson
description: 在本教程中我们将介绍如何包含排序 DataList 和 Repeater 中的支持，以及如何构造其数据可以 DataList 或 Repeater...
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/13/2006
ms.topic: article
ms.assetid: f52c302a-1b7c-46fe-8a13-8412c95cbf6d
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
msc.type: authoredcontent
ms.openlocfilehash: 85b59040cce266165353fe1627ffd983473bdcb6
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/03/2018
ms.locfileid: "37371628"
---
<a name="sorting-data-in-a-datalist-or-repeater-control-c"></a><span data-ttu-id="f5bcf-103">排序 DataList 或 Repeater 控件 (C#) 中的数据</span><span class="sxs-lookup"><span data-stu-id="f5bcf-103">Sorting Data in a DataList or Repeater Control (C#)</span></span>
====================
<span data-ttu-id="f5bcf-104">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f5bcf-105">[下载示例应用程序](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe)或[下载 PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span></span>

> <span data-ttu-id="f5bcf-106">在本教程中我们将介绍如何包含排序 DataList 和 Repeater 中的支持，以及如何构造 DataList 或 Repeater 分页和排序的数据。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="f5bcf-107">介绍</span><span class="sxs-lookup"><span data-stu-id="f5bcf-107">Introduction</span></span>

<span data-ttu-id="f5bcf-108">在中[前一篇教程](paging-report-data-in-a-datalist-or-repeater-control-cs.md)中，我们探讨如何将分页支持添加到 DataList。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="f5bcf-109">我们创建了中的新方法`ProductsBLL`类 (`GetProductsAsPagedDataSource`) 返回`PagedDataSource`对象。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="f5bcf-110">当绑定到 DataList 或 Repeater、 DataList 或 Repeater 将显示只是请求的数据页。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="f5bcf-111">此技术非常类似于使用在内部由 GridView、 DetailsView 和 FormView 控件来提供其内置的默认分页功能。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="f5bcf-112">除了提供分页支持的 GridView 还包括现成排序支持。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="f5bcf-113">DataList 和 Repeater 都不提供内置排序功能;但是，使用少量的代码添加排序功能。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="f5bcf-114">在本教程中我们将介绍如何包含排序 DataList 和 Repeater 中的支持，以及如何构造 DataList 或 Repeater 分页和排序的数据。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="f5bcf-115">排序的评审</span><span class="sxs-lookup"><span data-stu-id="f5bcf-115">A Review of Sorting</span></span>

<span data-ttu-id="f5bcf-116">中可以看到[分页和排序报表数据](../paging-and-sorting/paging-and-sorting-report-data-cs.md)教程中，提供排序支持现成的 GridView 控件。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-cs.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="f5bcf-117">GridView 中的每个字段可以具有关联`SortExpression`，指示对数据进行排序所依据的数据字段。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="f5bcf-118">当 GridView s`AllowSorting`属性设置为`true`，具有每个 GridView 字段`SortExpression`属性值已作为 LinkButton 呈现其标头。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="f5bcf-119">当用户单击特定的 GridView 字段 s 标头时，产生的回发和被单击字段 s 根据数据进行排序`SortExpression`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="f5bcf-120">GridView 控件具有`SortExpression`属性，它将存储`SortExpression`GridView 字段的数据进行排序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="f5bcf-121">此外，`SortDirection`属性指示数据是否按升序或降序 （如果用户单击切换中的某个特定 GridView 字段 s 标头链接两次连续的排序顺序） 排序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="f5bcf-122">当 GridView 绑定到其数据源控件时，将提交其`SortExpression`和`SortDirection`属性对数据源控件。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="f5bcf-123">数据源控件检索数据，然后对其进行排序根据所提供`SortExpression`和`SortDirection`属性。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="f5bcf-124">对数据进行排序之后, 的数据源控件将其返回到 GridView。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="f5bcf-125">若要复制的 DataList 或 Repeater 控件使用此功能，我们必须：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="f5bcf-126">创建排序的接口</span><span class="sxs-lookup"><span data-stu-id="f5bcf-126">Create a sorting interface</span></span>
- <span data-ttu-id="f5bcf-127">请记住要作为排序依据的数据字段，以及是否按升序还是降序排序</span><span class="sxs-lookup"><span data-stu-id="f5bcf-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="f5bcf-128">指示对象数据源的特定数据字段的数据进行排序</span><span class="sxs-lookup"><span data-stu-id="f5bcf-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="f5bcf-129">例如，我们将介绍这三个任务在步骤 3 和 4。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="f5bcf-130">接下来，我们将介绍如何包含都分页和排序 DataList 或 Repeater 中的支持。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="f5bcf-131">步骤 2： 在 Repeater 中显示产品</span><span class="sxs-lookup"><span data-stu-id="f5bcf-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="f5bcf-132">我们担心实现任何与排序相关的功能之前，让 s 首先列出 Repeater 控件中的产品。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="f5bcf-133">首先打开`Sorting.aspx`页中`PagingSortingDataListRepeater`文件夹。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="f5bcf-134">将 Repeater 控件添加到 web 页上，设置其`ID`属性设置为`SortableProducts`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="f5bcf-135">从 Repeater s 智能标记，创建名为新 ObjectDataSource`ProductsDataSource`并将其配置为从`ProductsBLL`类的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="f5bcf-136">（无） 从下拉列表中的 INSERT、 UPDATE 和 DELETE 的选项卡中选项的选择。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="f5bcf-137">[![创建对象数据源，并将其配置为使用 GetProductsAsPagedDataSource() 方法](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="f5bcf-138">**图 1**： 创建对象数据源，并将其配置为使用`GetProductsAsPagedDataSource()`方法 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span></span>


<span data-ttu-id="f5bcf-139">[![设置下拉列表中插入、 更新和删除选项卡添加到 （无）](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="f5bcf-140">**图 2**： 设置的下拉列表中插入、 更新和删除选项卡添加到 （无） ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span></span>


<span data-ttu-id="f5bcf-141">与使用 DataList 和 Visual Studio 不会自动创建`ItemTemplate`Repeater 控件后将其绑定到数据源。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="f5bcf-142">此外，我们必须添加此`ItemTemplate`以声明方式，因为 Repeater 控件 s 智能标记缺少 DataList s 中找到编辑模板选项。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="f5bcf-143">允许 s 使用相同`ItemTemplate`从前面的教程，其中显示 s 产品名称、 供应商和类别。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="f5bcf-144">添加后`ItemTemplate`，Repeater 和 ObjectDataSource s 声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample1.aspx)]

<span data-ttu-id="f5bcf-145">图 3 显示时的浏览器查看此页。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="f5bcf-146">[![显示每个产品的名称、 供应商和类别](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="f5bcf-147">**图 3**： 显示每个产品名称、 供应商和类别 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="f5bcf-148">步骤 3： 指示 ObjectDataSource 对数据进行排序</span><span class="sxs-lookup"><span data-stu-id="f5bcf-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="f5bcf-149">若要显示中继器中的数据进行排序，我们需要通知的数据进行排序所依据的排序表达式的对象数据源。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="f5bcf-150">对象数据源中检索其数据之前，它会首先触发其[`Selecting`事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx)，其中提供了机会，我们要指定排序表达式。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="f5bcf-151">`Selecting`事件处理程序传递类型的对象[ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx)，其中有一个名为[ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx)类型的[ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="f5bcf-152">`DataSourceSelectArguments`类用于将与数据相关的请求的数据使用者从传递到数据源控件，并包含[`SortExpression`属性](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="f5bcf-153">若要将从 ASP.NET 页的排序信息传递到对象数据源，创建的事件处理程序`Selecting`事件并使用以下代码：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample2.cs)]

<span data-ttu-id="f5bcf-154">*SortExpression*应将值分配 （例如产品名称) 的数据进行排序的数据字段的名称。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="f5bcf-155">没有任何排序方向相关属性，因此如果你想要将数据按降序排序，追加字符串 DESC 到*sortExpression*值 （如 ProductName DESC)。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="f5bcf-156">请继续并尝试一些不同硬编码的值*sortExpression*和浏览器中测试的结果。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="f5bcf-157">如图 4 所示，当使用作为产品名称 DESC *sortExpression*，产品按反向字母顺序在其名称进行排序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="f5bcf-158">[![按其名称按反向字母顺序排序的产品](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="f5bcf-159">**图 4**： 按其名称按反向字母顺序排序的产品 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="f5bcf-160">步骤 4： 创建排序的接口，然后记住的排序表达式和方向</span><span class="sxs-lookup"><span data-stu-id="f5bcf-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="f5bcf-161">开启排序 GridView 中的支持将 LinkButton 转换为每个排序字段 s 标头文本，单击时，相应地排序数据。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="f5bcf-162">此类排序接口有意义的 GridView，其中其整齐地布置数据列中。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="f5bcf-163">DataList 和 Repeater 控件，但是，不同的排序接口需要。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="f5bcf-164">一组数据 （而不是数据网格中），一个常见排序界面是提供的数据可以进行排序所依据的字段的下拉列表。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="f5bcf-165">让我们来实现本教程的此类接口。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="f5bcf-166">添加上述 DropDownList Web 控件`SortableProducts`Repeater 并设置其`ID`属性设置为`SortBy`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="f5bcf-167">从属性窗口中，单击省略号中的`Items`属性可以打开 ListItem 集合编辑器。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="f5bcf-168">添加`ListItem`s 的数据进行排序`ProductName`， `CategoryName`，和`SupplierName`字段。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="f5bcf-169">此外将添加`ListItem`要按其名称按反向字母顺序排序产品。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="f5bcf-170">`ListItem` `Text`属性可以设置为任何值 （如名称），但`Value`属性必须设置为 （例如产品名称) 的数据字段的名称。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="f5bcf-171">按降序对结果进行排序，请将字符串 DESC 追加到 ProductName DESC 类似的数据字段名称。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![将 ListItem 添加每个可排序的数据字段](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image13.png)

<span data-ttu-id="f5bcf-173">**图 5**： 添加`ListItem`每个可排序的数据字段</span><span class="sxs-lookup"><span data-stu-id="f5bcf-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="f5bcf-174">最后，右侧的下拉列表中添加一个按钮 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="f5bcf-175">设置其`ID`到`RefreshRepeater`并将其`Text`刷新属性。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="f5bcf-176">在创建后`ListItem`s，并添加刷新按钮，DropDownList 和按钮 s 声明性语法应看起来类似于下面：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample3.aspx)]

<span data-ttu-id="f5bcf-177">与排序下拉列表中完成，我们接下来需要更新的 ObjectDataSource s`Selecting`事件处理程序，以便使用所选`SortBy``ListItem`s`Value`属性而不是硬编码的排序表达式。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample4.cs)]

<span data-ttu-id="f5bcf-178">在首次访问页面时此点产品将最初按排序`ProductName`数据字段，因为它 s `SortBy` `ListItem`默认情况下选择 （请参阅图 6）。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="f5bcf-179">选择一个不同的排序选项，如类别和单击刷新将导致回发，并重新对数据进行排序的类别名称，如图 7 所示。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="f5bcf-180">[![产品是最初按其名称排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span></span>

<span data-ttu-id="f5bcf-181">**图 6**: 产品是最初按其名称 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span></span>


<span data-ttu-id="f5bcf-182">[![产品是现在按类别排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span></span>

<span data-ttu-id="f5bcf-183">**图 7**: 产品是现在，按类别进行排序 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f5bcf-184">单击刷新按钮会导致数据自动进行重新排序因为已禁用的 Repeater 的视图状态，从而导致 Repeater 重新绑定到其数据源上每次回发。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="f5bcf-185">如果你已留 Repeater s 启用视图状态，更改排序下拉列表结束-赢得 t 上的排序顺序产生任何影响。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won t have any affect on the sort order.</span></span> <span data-ttu-id="f5bcf-186">若要解决此问题，创建事件处理程序的刷新按钮 s`Click`事件和重新绑定到其数据源 Repeater (通过调用 Repeater 的`DataBind()`方法)。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="f5bcf-187">记住的排序表达式和方向</span><span class="sxs-lookup"><span data-stu-id="f5bcf-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="f5bcf-188">在非排序相关可能会发生回发，页面上创建的可排序 DataList 或 Repeater 时它 s 命令性，在回发之间记住的排序表达式和方向。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="f5bcf-189">例如，假设我们在此教程，包括每个产品的删除按钮更新 Repeater。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="f5bcf-190">当用户单击删除按钮 d 我们运行一些代码以删除所选的产品，然后重新绑定到 Repeater 的数据。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="f5bcf-191">如果不会在回发之间保留排序详细信息，在屏幕上显示的数据将恢复为原始的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="f5bcf-192">对于本教程，DropDownList 隐式排序表达式和方向在中保存其视图状态为我们。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="f5bcf-193">如果我们使用不同的排序接口之一，即 Linkbutton 提供不同的排序选项 d 我们需要小心回发之间保留排序顺序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="f5bcf-194">这可以通过将排序参数存储在页的视图状态中，通过包括排序参数，在查询字符串中或通过某些其他状态暂留技术来实现。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="f5bcf-195">在本教程中的未来示例探索如何持久保存页面的视图状态中的排序详细信息。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="f5bcf-196">步骤 5： 添加到使用默认的分页 DataList 排序的支持</span><span class="sxs-lookup"><span data-stu-id="f5bcf-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="f5bcf-197">在中[前面的教程](paging-report-data-in-a-datalist-or-repeater-control-cs.md)介绍了如何实现使用 DataList 默认分页。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="f5bcf-198">让我们来扩展这一示例，包括能够对分页的数据进行排序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="f5bcf-199">首先打开`SortingWithDefaultPaging.aspx`并`Paging.aspx`中的页面`PagingSortingDataListRepeater`文件夹。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="f5bcf-200">从`Paging.aspx`页上，单击源按钮以查看页面 s 声明性标记。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="f5bcf-201">复制选定的文本 （请参阅图 8） 将其粘贴到的声明性标记`SortingWithDefaultPaging.aspx`之间`<asp:Content>`标记。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="f5bcf-202">[![复制中的声明性标记&lt;asp: Content&gt; SortingWithDefaultPaging.aspx 从 Paging.aspx 标记](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span></span>

<span data-ttu-id="f5bcf-203">**图 8**： 复制中的声明性标记`<asp:Content>`从标记`Paging.aspx`到`SortingWithDefaultPaging.aspx`([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span></span>


<span data-ttu-id="f5bcf-204">复制后的声明性标记，请将复制的方法和属性中的`Paging.aspx`页上的代码隐藏类的代码隐藏类`SortingWithDefaultPaging.aspx`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="f5bcf-205">接下来，花点时间查看`SortingWithDefaultPaging.aspx`页在浏览器中。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="f5bcf-206">它应表现出相同的功能和外观`Paging.aspx`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="f5bcf-207">增强 ProductsBLL 包括默认分页和排序方法</span><span class="sxs-lookup"><span data-stu-id="f5bcf-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="f5bcf-208">在上一教程中，我们将创建`GetProductsAsPagedDataSource(pageIndex, pageSize)`中的方法`ProductsBLL`类返回`PagedDataSource`对象。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="f5bcf-209">这`PagedDataSource`对象已填入*所有*的产品 (通过 BLL s`GetProducts()`方法)，但只有那些对应于指定的记录时绑定到 DataList *pageIndex*并*pageSize*显示输入的参数。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="f5bcf-210">在本教程前面添加了排序支持通过指定的排序表达式从 ObjectDataSource 的`Selecting`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="f5bcf-211">此用法非常有效 ObjectDataSource 时返回一个对象，可以进行排序，如`ProductsDataTable`返回的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="f5bcf-212">但是，`PagedDataSource`返回对象`GetProductsAsPagedDataSource`方法不支持其内部数据源的排序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="f5bcf-213">相反，我们需要进行排序，从返回的结果`GetProducts()`方法*之前*我们将其放入`PagedDataSource`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="f5bcf-214">若要实现此目的，创建中的新方法`ProductsBLL`类， `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="f5bcf-215">若要进行排序`ProductsDataTable`返回的`GetProducts()`方法中，指定`Sort`其默认值的属性`DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="f5bcf-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample5.cs)]

<span data-ttu-id="f5bcf-216">`GetProductsSortedAsPagedDataSource`方法只稍有不同从`GetProductsAsPagedDataSource`在上一教程中创建的方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="f5bcf-217">具体而言，`GetProductsSortedAsPagedDataSource`接受其他输入的参数`sortExpression`，并将分配此值设置为`Sort`的属性`ProductDataTable`s `DefaultView`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="f5bcf-218">少量的代码更高版本，行`PagedDataSource`分配对象 s 数据源`ProductDataTable`s `DefaultView`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="f5bcf-219">调用 GetProductsSortedAsPagedDataSource 方法并指定 SortExpression 输入参数的值</span><span class="sxs-lookup"><span data-stu-id="f5bcf-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="f5bcf-220">使用`GetProductsSortedAsPagedDataSource`方法完成下, 一步是为此参数提供值。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="f5bcf-221">在 ObjectDataSource`SortingWithDefaultPaging.aspx`当前配置为调用`GetProductsAsPagedDataSource`方法，并通过其两个在两个输入参数中的传递`QueryStringParameters`，指定在`SelectParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="f5bcf-222">这两个`QueryStringParameters`指示的源`GetProductsAsPagedDataSource`s 方法*pageIndex*并*pageSize*参数来自查询字符串字段`pageIndex`和`pageSize`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="f5bcf-223">更新的 ObjectDataSource s`SelectMethod`属性，以便它调用新`GetProductsSortedAsPagedDataSource`方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="f5bcf-224">然后，添加一个新`QueryStringParameter`，以便*sortExpression*从查询字符串字段访问输入的参数`sortExpression`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="f5bcf-225">设置`QueryStringParameter`s`DefaultValue`为产品名称。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="f5bcf-226">这些更改后的 ObjectDataSource s 声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample6.aspx)]

<span data-ttu-id="f5bcf-227">此时，`SortingWithDefaultPaging.aspx`页将按产品名称按字母顺序排序其结果 （请参阅图 9）。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="f5bcf-228">这是因为，默认情况下，值为产品名称作为传入`GetProductsSortedAsPagedDataSource`s 方法*sortExpression*参数。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="f5bcf-229">[![默认情况下，对结果进行排序的产品名称](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span></span>

<span data-ttu-id="f5bcf-230">**图 9**： 默认情况下，对结果进行排序由`ProductName`([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span></span>


<span data-ttu-id="f5bcf-231">如果你手动添加`sortExpression`查询字符串字段，如`SortingWithDefaultPaging.aspx?sortExpression=CategoryName`将对结果进行排序由指定`sortExpression`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="f5bcf-232">但是，这`sortExpression`参数未包含在查询字符串中，将移动到另一页数据时。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="f5bcf-233">事实上，单击下一步或最后一页按钮的操作我们返回`Paging.aspx`！</span><span class="sxs-lookup"><span data-stu-id="f5bcf-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="f5bcf-234">此外，有 s 当前未排序的接口。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="f5bcf-235">用户可以更改分页的数据的排序顺序的唯一方法是通过直接操作在查询字符串。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="f5bcf-236">创建排序的接口</span><span class="sxs-lookup"><span data-stu-id="f5bcf-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="f5bcf-237">我们首先需要更新`RedirectUser`方法将向用户发送`SortingWithDefaultPaging.aspx`(而不是`Paging.aspx`)，它包括`sortExpression`在查询字符串中的值。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="f5bcf-238">我们还应添加一个只读的页面级名为`SortExpression`属性。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="f5bcf-239">此属性，类似于`PageIndex`并`PageSize`在上一教程中创建的属性返回的值`sortExpression`查询字符串字段存在，如果和默认值 (ProductName)，否则。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="f5bcf-240">当前`RedirectUser`方法接受仅单个输入的参数，要显示的页的索引。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="f5bcf-241">但是，可能是我们想要将用户重定向到特定页面使用以外的新增功能在查询字符串中指定的排序表达式的数据。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="f5bcf-242">稍后我们将创建此页上，将包括一系列按钮 Web 控件，用于对数据进行排序的指定列的排序接口。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="f5bcf-243">单击这些按钮之一时，我们想要传递相应的排序表达式值中将用户重定向。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="f5bcf-244">若要提供此功能，创建两个版本的`RedirectUser`方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="f5bcf-245">第一个应接受仅页索引若要显示，而第二个接受的页索引和排序表达式。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample7.cs)]

<span data-ttu-id="f5bcf-246">在本教程中的第一个示例，我们将创建使用 DropDownList 排序接口。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="f5bcf-247">对于此示例中，let s 使用三个按钮 Web 控件进行排序的上方 DataList 一个定位`ProductName`、 一个用于`CategoryName`，，另一个用于`SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="f5bcf-248">添加三个按钮 Web 控件，设置其`ID`和`Text`属性正确：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample8.aspx)]

<span data-ttu-id="f5bcf-249">接下来，创建`Click`为每个事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="f5bcf-250">事件处理程序应调用`RedirectUser`方法，并返回到使用相应的排序表达式的第一页的用户。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample9.cs)]

<span data-ttu-id="f5bcf-251">当首次访问的页面，按产品名称按字母顺序进行排序数据 （回头查看图 9）。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="f5bcf-252">单击下一步按钮以转到第二个数据页，然后单击类别按钮的排序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="f5bcf-253">这将我们返回到按类别名称排序的数据的第一页 （请参阅图 10）。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="f5bcf-254">同样，由供应商按钮单击排序对从数据的第一页开始的供应商数据进行排序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="f5bcf-255">如将数据分页通过记住排序选项。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="f5bcf-256">图 11 显示后按类别排序，然后然后转到第 13 个数据页的页。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="f5bcf-257">[![产品按类别排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span></span>

<span data-ttu-id="f5bcf-258">**图 10**： 按类别排序的产品 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span></span>


<span data-ttu-id="f5bcf-259">[![排序表达式是记住分页通过数据时](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span></span>

<span data-ttu-id="f5bcf-260">**图 11**: 排序表达式是记住分页通过数据时 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="f5bcf-261">通过 Repeater 中的记录的步骤 6： 自定义分页</span><span class="sxs-lookup"><span data-stu-id="f5bcf-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="f5bcf-262">DataList 示例检查在步骤中通过使用效率低下默认分页方法及其数据的 5 个页面。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="f5bcf-263">时分页的数据量足够大，则必须使用自定义分页。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="f5bcf-264">回到[有效地分页通过大数量的数据](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md)和[自定义分页对数据进行排序](../paging-and-sorting/sorting-custom-paged-data-cs.md)教程，我们检查的 BLL 中默认和自定义分页和创建的方法的区别利用自定义分页和排序自定义分页的数据。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-cs.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="f5bcf-265">具体而言，在这些两个以前的教程，我们添加到以下三种方法`ProductsBLL`类：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="f5bcf-266">`GetProductsPaged(startRowIndex, maximumRows)` 返回从开始记录的特定子集*startRowIndex*和不超过*值*。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="f5bcf-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` 返回按指定的记录的特定子集*sortExpression*输入的参数。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="f5bcf-268">`TotalNumberOfProducts()` 提供了中的记录总数`Products`数据库表。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="f5bcf-269">这些方法可用于高效地页上，并通过使用 DataList 或 Repeater 控件的数据进行排序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="f5bcf-270">为了说明这一点，让我们来首先创建 Repeater 控件具有自定义分页支持;然后，我们将添加排序功能。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="f5bcf-271">打开`SortingWithCustomPaging.aspx`页中`PagingSortingDataListRepeater`文件夹并将 Repeater 添加到页上，设置其`ID`属性设置为`Products`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="f5bcf-272">在 Repeater s 智能标记，创建名为新 ObjectDataSource `ProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="f5bcf-273">将其配置为选择从其数据`ProductsBLL`类的`GetProductsPaged`方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="f5bcf-274">[![配置对象数据源使用 ProductsBLL 类的 GetProductsPaged 方法](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span></span>

<span data-ttu-id="f5bcf-275">**图 12**： 配置为使用 ObjectDataSource`ProductsBLL`类 s`GetProductsPaged`方法 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span></span>


<span data-ttu-id="f5bcf-276">设置下拉列表中插入、 更新和删除选项卡添加到 （无），然后单击下一步按钮。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="f5bcf-277">配置数据源向导现在会提示对的源`GetProductsPaged`s 方法*startRowIndex*并*值*输入参数。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="f5bcf-278">在现实中，将忽略这些输入的参数。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="f5bcf-279">相反， *startRowIndex*并*值*值将通过传入`Arguments`属性中的 ObjectDataSource 的`Selecting`事件处理程序，就像我们指定的方式*sortExpression*中第一篇教程 s 的演示。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="f5bcf-280">因此，将参数源保留在向导中设置为 None 的下拉列表。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="f5bcf-281">[![将参数源设置为 None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span></span>

<span data-ttu-id="f5bcf-282">**图 13**： 保留参数源设置为无 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f5bcf-283">不要*不*设置的 ObjectDataSource s`EnablePaging`属性设置为`true`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="f5bcf-284">这将导致对象数据源，将自动包含其自身*startRowIndex*并*值*参数`SelectMethod`s 现有参数列表。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="f5bcf-285">`EnablePaging`属性绑定自定义分页到 GridView、 detailsview 和 FormView 控件的数据，因为遇到 ObjectDataSource s 中的某些行为，这些控件时很有用时才可用`EnablePaging`属性是`true`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="f5bcf-286">由于我们必须手动添加的 DataList 和 Repeater 分页支持，因此将此属性设置为`false`（默认值），因为我们将直接在我们的 ASP.NET 页面中完了所需的功能。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="f5bcf-287">最后，定义 Repeater 的`ItemTemplate`以便显示产品的名称、 类别和供应商。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="f5bcf-288">这些更改后 Repeater 和 ObjectDataSource s 声明性语法应看起来类似于下面：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample10.aspx)]

<span data-ttu-id="f5bcf-289">请花费片刻时间，请访问通过浏览器页面，并记下不返回任何记录。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="f5bcf-290">这是因为我们尚未以指定的 ve *startRowIndex*和*值*参数值; 因此，值为 0 传递中两个。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="f5bcf-291">若要指定这些值，请创建事件处理程序的 ObjectDataSource s`Selecting`事件并设置这些参数值以编程方式为硬编码值为 0，5，分别：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample11.cs)]

<span data-ttu-id="f5bcf-292">进行此更改后，页上，当浏览器中，通过查看显示前五个产品。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="f5bcf-293">[![显示前五个记录](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span></span>

<span data-ttu-id="f5bcf-294">**图 14**： 显示前五个记录 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f5bcf-295">图 14 中列出的产品碰巧按产品名称排序，因为`GetProductsPaged`执行高效的自定义分页查询的存储的过程通过对结果进行排序`ProductName`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="f5bcf-296">若要允许用户浏览所有页面，我们需要跟踪的起始行索引和最大行数和回发之间保留这些值。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="f5bcf-297">在默认的分页示例中我们使用查询字符串字段以保留这些值;对于此演示，让我们来永久保存此页的视图状态信息。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="f5bcf-298">创建以下两个属性：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-298">Create the following two properties:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample12.cs)]

<span data-ttu-id="f5bcf-299">接下来，更新选择事件处理程序中的代码，以便它使用`StartRowIndex`和`MaximumRows`属性而不是 0 和 5 的硬编码值：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample13.cs)]

<span data-ttu-id="f5bcf-300">此时我们的页面仍将显示的前五个记录为止。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="f5bcf-301">但是，使用这些属性中的位置，我们准备就绪后，若要创建我们分页界面。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="f5bcf-302">添加分页接口</span><span class="sxs-lookup"><span data-stu-id="f5bcf-302">Adding the Paging Interface</span></span>

<span data-ttu-id="f5bcf-303">允许的使用相同的第一个、 上一步、 下一步上, 一次分页接口用于默认分页示例，其中包括查看显示哪些页数据的控件，则标签 Web 和存在多少总页数。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="f5bcf-304">添加四个按钮 Web 控件和 Repeater 下方的标签。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample14.aspx)]

<span data-ttu-id="f5bcf-305">接下来，创建`Click`的四个按钮的事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="f5bcf-306">单击其中一个按钮时，我们需要更新`StartRowIndex`和重新绑定到 Repeater 的数据。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="f5bcf-307">第一个、 上一步，和下一步按钮的代码非常简单，但对于最后一个按钮如何我们确定数据的最后一页的起始行索引？</span><span class="sxs-lookup"><span data-stu-id="f5bcf-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="f5bcf-308">若要计算此索引，以及能够确定是否应启用下一步和最后一个按钮，我们需要知道总共多少条记录已被分页通过。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="f5bcf-309">我们可以通过调用来确定这`ProductsBLL`类的`TotalNumberOfProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="f5bcf-310">允许 s 创建一个名为只读的、 页面级别属性`TotalRowCount`返回的结果`TotalNumberOfProducts()`方法：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample15.cs)]

<span data-ttu-id="f5bcf-311">使用此属性现在我们可以确定最后一个页面 + s 起始行索引。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="f5bcf-312">具体而言，它 s 整数结果的`TotalRowCount`减 1 除以`MaximumRows`，再乘以`MaximumRows`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="f5bcf-313">现在，我们可以编写`Click`的四个分页界面按钮事件处理程序：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample16.cs)]

<span data-ttu-id="f5bcf-314">最后，我们需要查看的最后一页时查看数据和下一步和最后一个按钮的第一页时禁用分页界面中的第一个和上一步按钮。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="f5bcf-315">若要完成此操作，请将以下代码添加到 ObjectDataSource 的`Selecting`事件处理程序：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample17.cs)]

<span data-ttu-id="f5bcf-316">添加这些后`Click`事件处理程序和代码以启用或禁用分页界面元素基于当前的起始行索引，在浏览器中测试页。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="f5bcf-317">如图 15 所示，当首次访问页面第一个和上一步按钮将处于禁用状态。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="f5bcf-318">单击下一步显示第二个数据页中的，单击上一次显示的最后一页时 （请参阅图 16 和 17）。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="f5bcf-319">查看数据的最后一页时的下一步和最后一个按钮被禁用。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="f5bcf-320">[![上一步和最后一个按钮已禁用时查看第一个产品页](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span></span>

<span data-ttu-id="f5bcf-321">**图 15**： 查看第一个产品页时，将禁用上一个和最后一个按钮 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span></span>


<span data-ttu-id="f5bcf-322">[![第二个产品页是全都](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span></span>

<span data-ttu-id="f5bcf-323">**图 16**： 产品第二个页面是全都 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span></span>


<span data-ttu-id="f5bcf-324">[![单击最后一个显示数据的最后一页](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span></span>

<span data-ttu-id="f5bcf-325">**图 17**： 单击上一次显示的最后一个数据页 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="f5bcf-326">步骤 7： 包括排序使用的自定义支持分页 Repeater</span><span class="sxs-lookup"><span data-stu-id="f5bcf-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="f5bcf-327">现在，已实现自定义分页，我们准备就绪后，若要包括排序支持。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="f5bcf-328">`ProductsBLL`类 s`GetProductsPagedAndSorted`方法具有相同*startRowIndex*并*值*输入参数作为`GetProductsPaged`，但它允许其他*sortExpression*输入的参数。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="f5bcf-329">若要使用`GetProductsPagedAndSorted`方法从`SortingWithCustomPaging.aspx`，我们需要执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="f5bcf-330">更改 ObjectDataSource s`SelectMethod`属性从`GetProductsPaged`到`GetProductsPagedAndSorted`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="f5bcf-331">添加*sortExpression* `Parameter`对象为 ObjectDataSource 的`SelectParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="f5bcf-332">创建专用的页级`SortExpression`通过页的视图状态的回发中保留其值的属性。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="f5bcf-333">更新的 ObjectDataSource s`Selecting`事件处理程序分配的 ObjectDataSource s *sortExpression*参数的值的页级`SortExpression`属性。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="f5bcf-334">创建排序的接口。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-334">Create the sorting interface.</span></span>

<span data-ttu-id="f5bcf-335">通过更新 ObjectDataSource s 开始`SelectMethod`属性并添加*sortExpression* `Parameter`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="f5bcf-336">请确保*sortExpression* `Parameter` s`Type`属性设置为`String`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="f5bcf-337">以后完成前两项任务，ObjectDataSource s 声明性标记看起来应如下所示：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample18.aspx)]

<span data-ttu-id="f5bcf-338">接下来，我们需要一个页面级`SortExpression`属性的值序列化，以查看状态。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="f5bcf-339">如果已设置排序表达式值，使用产品名称为默认值：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample19.cs)]

<span data-ttu-id="f5bcf-340">ObjectDataSource 调用之前`GetProductsPagedAndSorted`方法，我们需要设置*sortExpression* `Parameter`的值`SortExpression`属性。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="f5bcf-341">在`Selecting`事件处理程序中，添加以下代码行：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample20.cs)]

<span data-ttu-id="f5bcf-342">所有的就是实现排序的接口。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="f5bcf-343">与我们在上一示例中，可让具有排序实现的接口使用三个按钮 Web 控件允许用户对结果进行排序的产品名称、 类别或供应商的 s。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample21.aspx)]

<span data-ttu-id="f5bcf-344">创建`Click`这三个按钮控件的事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="f5bcf-345">在事件处理程序，重置`StartRowIndex`为 0，设置`SortExpression`到适当的值，并重新绑定到 Repeater 的数据：</span><span class="sxs-lookup"><span data-stu-id="f5bcf-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample22.cs)]

<span data-ttu-id="f5bcf-346">该 s 都在这里就简单 ！</span><span class="sxs-lookup"><span data-stu-id="f5bcf-346">That s all there is to it!</span></span> <span data-ttu-id="f5bcf-347">虽然没有一系列步骤，若要获取自定义分页和排序实现，已非常类似于所需的默认分页执行步骤。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="f5bcf-348">图 18 查看数据时按类别排序的最后一页时显示的产品。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="f5bcf-349">[![显示数据的最后一页上，按类别中，](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span></span>

<span data-ttu-id="f5bcf-350">**图 18**： 显示数据最后一页上，按类别 ([单击以查看实际尺寸的图像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="f5bcf-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f5bcf-351">在上一示例中，供应商供应商名称已使用的排序表达式进行排序时。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="f5bcf-352">但是，有关自定义分页实现过程，我们需要使用公司名称。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="f5bcf-353">这是因为存储的过程负责实现自定义分页`GetProductsPagedAndSorted`将传递到排序表达式`ROW_NUMBER()`关键字，`ROW_NUMBER()`关键字需要实际的列名称而不是别名。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="f5bcf-354">因此，我们必须使用`CompanyName`(在列的名称`Suppliers`表) 而不是在中使用的别名`SELECT`查询 (`SupplierName`) 的排序表达式。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="f5bcf-355">总结</span><span class="sxs-lookup"><span data-stu-id="f5bcf-355">Summary</span></span>

<span data-ttu-id="f5bcf-356">既不 DataList 和 Repeater 提供排序的内置支持，但可以在进行少量的代码和自定义排序界面，添加此类功能。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="f5bcf-357">在实现排序，但不是分页时，可以通过指定的排序表达式`DataSourceSelectArguments`对象传递到 ObjectDataSource 的`Select`方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="f5bcf-358">这`DataSourceSelectArguments`对象 s`SortExpression`可以将属性分配中的 ObjectDataSource 的`Selecting`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="f5bcf-359">若要添加到 DataList 或 Repeater 已提供分页支持的排序功能，最简单的方法是自定义业务逻辑层包含接受的排序表达式的方法。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="f5bcf-360">此信息然后中通过 ObjectDataSource s 中的参数传递`SelectParameters`。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="f5bcf-361">本教程中完成分页和排序使用 DataList 和 Repeater 控件的探讨。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="f5bcf-362">我们的下一步和最后一个教程将介绍如何将按钮 Web 控件添加到 DataList 和 Repeater 的模板，以便在每个项的基础上提供某些自定义、 用户启动的功能。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="f5bcf-363">快乐编程 ！</span><span class="sxs-lookup"><span data-stu-id="f5bcf-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f5bcf-364">关于作者</span><span class="sxs-lookup"><span data-stu-id="f5bcf-364">About the Author</span></span>

<span data-ttu-id="f5bcf-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)的七个部 asp/ASP.NET 书籍并创办了作者[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年以来一直致力于 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f5bcf-366">Scott 是独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f5bcf-367">他最新著作是[ *Sams Teach 自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f5bcf-368">他可以到达[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f5bcf-369">或通过他的博客，其中，请参阅[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f5bcf-370">特别感谢</span><span class="sxs-lookup"><span data-stu-id="f5bcf-370">Special Thanks To</span></span>

<span data-ttu-id="f5bcf-371">很多有用的审阅者已评审本系列教程。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f5bcf-372">本教程中的潜在顾客审阅者是 David Suru。</span><span class="sxs-lookup"><span data-stu-id="f5bcf-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="f5bcf-373">是否有兴趣查看我即将推出的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="f5bcf-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f5bcf-374">如果是这样，给我在行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f5bcf-375">[上一页](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
> [下一页](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f5bcf-375">[Previous](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Next](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span></span>
