---
uid: web-forms/overview/data-access/masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb
title: 使用详细信息 DetailView (VB) 的可选母版 GridView 母版/详细信息 |Microsoft Docs
author: rick-anderson
description: 本教程将具有的 GridView 中的行包括名称和选择按钮以及每个产品的价格。 单击选择按钮的 particu...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 1d1a7c93-971d-4690-9c5e-dac0e5014a09
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb
msc.type: authoredcontent
ms.openlocfilehash: a97323700e20aed12ee29674952f1ffe9144133c
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/03/2018
ms.locfileid: "37366036"
---
<a name="masterdetail-using-a-selectable-master-gridview-with-a-details-detailview-vb"></a><span data-ttu-id="92c6f-104">使用详细信息 DetailView (VB) 的可选母版 GridView 母版/详细信息</span><span class="sxs-lookup"><span data-stu-id="92c6f-104">Master/Detail Using a Selectable Master GridView with a Details DetailView (VB)</span></span>
====================
<span data-ttu-id="92c6f-105">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="92c6f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="92c6f-106">[下载示例应用程序](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_10_VB.exe)或[下载 PDF](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/datatutorial10vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="92c6f-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_10_VB.exe) or [Download PDF](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/datatutorial10vb1.pdf)</span></span>

> <span data-ttu-id="92c6f-107">本教程将具有的 GridView 中的行包括名称和选择按钮以及每个产品的价格。</span><span class="sxs-lookup"><span data-stu-id="92c6f-107">This tutorial will have a GridView whose rows include the name and price of each product along with a Select button.</span></span> <span data-ttu-id="92c6f-108">单击某一特定产品选择按钮将导致要在同一页面上的 DetailsView 控件中显示其完整的详细信息。</span><span class="sxs-lookup"><span data-stu-id="92c6f-108">Clicking the Select button for a particular product will cause its full details to be displayed in a DetailsView control on the same page.</span></span>


## <a name="introduction"></a><span data-ttu-id="92c6f-109">介绍</span><span class="sxs-lookup"><span data-stu-id="92c6f-109">Introduction</span></span>

<span data-ttu-id="92c6f-110">在中[前一篇教程](master-detail-filtering-across-two-pages-vb.md)我们已了解如何创建使用两个 web 页面的母版/详细信息报表:"主"的 web 页面，从中我们显示供应商提供; 的列表和"详细信息"网页列出所选提供这些产品供应商。</span><span class="sxs-lookup"><span data-stu-id="92c6f-110">In the [previous tutorial](master-detail-filtering-across-two-pages-vb.md) we saw how to create a master/detail report using two web pages: a "master" web page, from which we displayed the list of suppliers; and a "details" web page that listed those products provided by the selected supplier.</span></span> <span data-ttu-id="92c6f-111">此两个页面报告格式可以压缩到一个页面。</span><span class="sxs-lookup"><span data-stu-id="92c6f-111">This two page report format can be condensed into one page.</span></span> <span data-ttu-id="92c6f-112">本教程将具有的 GridView 中的行包括名称和选择按钮以及每个产品的价格。</span><span class="sxs-lookup"><span data-stu-id="92c6f-112">This tutorial will have a GridView whose rows include the name and price of each product along with a Select button.</span></span> <span data-ttu-id="92c6f-113">单击某一特定产品选择按钮将导致要在同一页面上的 DetailsView 控件中显示其完整的详细信息。</span><span class="sxs-lookup"><span data-stu-id="92c6f-113">Clicking the Select button for a particular product will cause its full details to be displayed in a DetailsView control on the same page.</span></span>


<span data-ttu-id="92c6f-114">[![单击选择按钮将显示产品的详细信息](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image2.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-114">[![Clicking the Select Button Displays the Product's Details](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image2.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image1.png)</span></span>

<span data-ttu-id="92c6f-115">**图 1**： 单击选择按钮将显示产品的详细信息 ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-115">**Figure 1**: Clicking the Select Button Displays the Product's Details ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image3.png))</span></span>


## <a name="step-1-creating-a-selectable-gridview"></a><span data-ttu-id="92c6f-116">步骤 1： 创建一个可选择的 GridView</span><span class="sxs-lookup"><span data-stu-id="92c6f-116">Step 1: Creating a Selectable GridView</span></span>

<span data-ttu-id="92c6f-117">回想一下，在两个页母版/详细信息报告每个主记录包含超链接，单击时，向用户发送到传递已单击的行的详细信息页`SupplierID`在查询字符串中的值。</span><span class="sxs-lookup"><span data-stu-id="92c6f-117">Recall that in the two-page master/detail report that each master record included a hyperlink that, when clicked, sent the user to the details page passing the clicked row's `SupplierID` value in the querystring.</span></span> <span data-ttu-id="92c6f-118">这样的超链接添加到每个使用 HyperLinkField 的 GridView 行。</span><span class="sxs-lookup"><span data-stu-id="92c6f-118">Such a hyperlink was added to each GridView row using a HyperLinkField.</span></span> <span data-ttu-id="92c6f-119">对于单个页面的母版/详细信息报表，我们将需要一个按钮，对每个 GridView 行，单击时，显示的详细信息。</span><span class="sxs-lookup"><span data-stu-id="92c6f-119">For the single page master/details report, we will need a Button for each GridView row that, when clicked, shows the details.</span></span> <span data-ttu-id="92c6f-120">可以将 GridView 控件配置为包括导致回发并将该行标记为 GridView 的每个行的选择按钮[SelectedRow](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedrow.aspx)。</span><span class="sxs-lookup"><span data-stu-id="92c6f-120">The GridView control can be configured to include a Select button for each row that causes a postback and marks that row as the GridView's [SelectedRow](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedrow.aspx).</span></span>

<span data-ttu-id="92c6f-121">首先，通过添加到 GridView 控件`DetailsBySelecting.aspx`页中`Filtering`文件夹中，设置其`ID`属性设置为`ProductsGrid`。</span><span class="sxs-lookup"><span data-stu-id="92c6f-121">Start by adding a GridView control to the `DetailsBySelecting.aspx` page in the `Filtering` folder, setting its `ID` property to `ProductsGrid`.</span></span> <span data-ttu-id="92c6f-122">接下来，添加名为新 ObjectDataSource `AllProductsDataSource` ，它调用`ProductsBLL`类的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="92c6f-122">Next, add a new ObjectDataSource named `AllProductsDataSource` that invokes the `ProductsBLL` class's `GetProducts()` method.</span></span>


<span data-ttu-id="92c6f-123">[![创建名为 AllProductsDataSource ObjectDataSource](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image5.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-123">[![Create an ObjectDataSource Named AllProductsDataSource](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image5.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image4.png)</span></span>

<span data-ttu-id="92c6f-124">**图 2**： 创建的 ObjectDataSource 命名`AllProductsDataSource`([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-124">**Figure 2**: Create an ObjectDataSource Named `AllProductsDataSource` ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image6.png))</span></span>


<span data-ttu-id="92c6f-125">[![使用 ProductsBLL 类](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image8.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-125">[![Use the ProductsBLL Class](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image8.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image7.png)</span></span>

<span data-ttu-id="92c6f-126">**图 3**： 使用`ProductsBLL`类 ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-126">**Figure 3**: Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image9.png))</span></span>


<span data-ttu-id="92c6f-127">[![配置 ObjectDataSource 调用 GetProducts() 方法](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image11.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-127">[![Configure the ObjectDataSource to Invoke the GetProducts() Method](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image11.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image10.png)</span></span>

<span data-ttu-id="92c6f-128">**图 4**： 配置对 Invoke ObjectDataSource`GetProducts()`方法 ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-128">**Figure 4**: Configure the ObjectDataSource to Invoke the `GetProducts()` Method ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image12.png))</span></span>


<span data-ttu-id="92c6f-129">编辑删除 GridView 的字段以外的所有`ProductName`和`UnitPrice`BoundFields。</span><span class="sxs-lookup"><span data-stu-id="92c6f-129">Edit the GridView's fields removing all but the `ProductName` and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="92c6f-130">此外，随时根据需要如格式设置自定义这些 BoundFields`UnitPrice`作为一种货币 BoundField 和更改`HeaderText`BoundFields 的属性。</span><span class="sxs-lookup"><span data-stu-id="92c6f-130">Also, feel free to customize these BoundFields as needed, such as formatting the `UnitPrice` BoundField as a currency and changing the `HeaderText` properties of the BoundFields.</span></span> <span data-ttu-id="92c6f-131">通过单击 GridView 的智能标记中的编辑列链接或通过手动配置的声明性语法，可以以图形方式，完成这些步骤。</span><span class="sxs-lookup"><span data-stu-id="92c6f-131">These steps can be accomplished graphically, by clicking the Edit Columns link from the GridView's smart tag, or by manually configuring the declarative syntax.</span></span>


<span data-ttu-id="92c6f-132">[![删除除之外的所有产品名称和单价 BoundFields](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image14.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-132">[![Remove All But the ProductName and UnitPrice BoundFields](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image14.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image13.png)</span></span>

<span data-ttu-id="92c6f-133">**图 5**： 删除以外的所有`ProductName`并`UnitPrice`BoundFields ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-133">**Figure 5**: Remove All But the `ProductName` and `UnitPrice` BoundFields ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image15.png))</span></span>


<span data-ttu-id="92c6f-134">GridView 的最后一个标记是：</span><span class="sxs-lookup"><span data-stu-id="92c6f-134">The final markup for the GridView is:</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample1.aspx)]

<span data-ttu-id="92c6f-135">接下来，我们需要将标记为可选的这样会将选择按钮添加到每个行 GridView。</span><span class="sxs-lookup"><span data-stu-id="92c6f-135">Next, we need to mark the GridView as selectable, which will add a Select button to each row.</span></span> <span data-ttu-id="92c6f-136">若要完成此操作，只需检查 GridView 的智能标记中的启用选定内容复选框。</span><span class="sxs-lookup"><span data-stu-id="92c6f-136">To accomplish this, simply check the Enable Selection checkbox in the GridView's smart tag.</span></span>


<span data-ttu-id="92c6f-137">[![确保 GridView 行选择](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image17.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-137">[![Make the GridView's Rows Selectable](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image17.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image16.png)</span></span>

<span data-ttu-id="92c6f-138">**图 6**： 使 GridView 行可选 ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-138">**Figure 6**: Make the GridView's Rows Selectable ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image18.png))</span></span>


<span data-ttu-id="92c6f-139">选中启用所选内容选项将添加到 CommandField `ProductsGrid` GridView 使用其`ShowSelectButton`属性设置为 True。</span><span class="sxs-lookup"><span data-stu-id="92c6f-139">Checking the Enabling Selection option adds a CommandField to the `ProductsGrid` GridView with its `ShowSelectButton` property set to True.</span></span> <span data-ttu-id="92c6f-140">这会导致选择按钮每行的 GridView 中，如图 6 所示。</span><span class="sxs-lookup"><span data-stu-id="92c6f-140">This results in a Select button for each row of the GridView, as Figure 6 illustrates.</span></span> <span data-ttu-id="92c6f-141">默认情况下，选择按钮呈现为 Linkbutton，但你可以使用按钮或 ImageButtons 改为通过 CommandField`ButtonType`属性。</span><span class="sxs-lookup"><span data-stu-id="92c6f-141">By default, the Select buttons are rendered as LinkButtons, but you can use Buttons or ImageButtons instead through the CommandField's `ButtonType` property.</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample2.aspx)]

<span data-ttu-id="92c6f-142">单击某 GridView 一行的选择按钮时，才会回发和 GridView`SelectedRow`更新属性。</span><span class="sxs-lookup"><span data-stu-id="92c6f-142">When a GridView row's Select button is clicked a postback ensues and the GridView's `SelectedRow` property is updated.</span></span> <span data-ttu-id="92c6f-143">除了`SelectedRow`属性，提供了 GridView [SelectedIndex](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedindex%28VS.80%29.aspx)， [SelectedValue](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedvalue%28VS.80%29.aspx)，并且[SelectedDataKey](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selecteddatakey%28VS.80%29.aspx)属性。</span><span class="sxs-lookup"><span data-stu-id="92c6f-143">In addition to the `SelectedRow` property, the GridView provides the [SelectedIndex](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedindex%28VS.80%29.aspx), [SelectedValue](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedvalue%28VS.80%29.aspx), and [SelectedDataKey](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selecteddatakey%28VS.80%29.aspx) properties.</span></span> <span data-ttu-id="92c6f-144">`SelectedIndex`属性返回所选行的索引，而`SelectedValue`并`SelectedDataKey`属性返回值基于 GridView [DataKeyNames 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames%28VS.80%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="92c6f-144">The `SelectedIndex` property returns the index of the selected row, whereas the `SelectedValue` and `SelectedDataKey` properties return values based upon the GridView's [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames%28VS.80%29.aspx).</span></span>

<span data-ttu-id="92c6f-145">`DataKeyNames`属性用于将一个或多个数据字段值与每个行，并通常用于属性唯一地标识信息从基础数据与每个 GridView 行。</span><span class="sxs-lookup"><span data-stu-id="92c6f-145">The `DataKeyNames` property is used to associate one or more data field values with each row and is commonly used to attribute uniquely identifying information from the underlying data with each GridView row.</span></span> <span data-ttu-id="92c6f-146">`SelectedValue`属性返回的值的第一个`DataKeyNames`所选行的数据字段作为 where`SelectedDataKey`属性返回所选的行`DataKey`对象，它包含的所有指定的数据键字段的值该行。</span><span class="sxs-lookup"><span data-stu-id="92c6f-146">The `SelectedValue` property returns the value of the first `DataKeyNames` data field for the selected row where as the `SelectedDataKey` property returns the selected row's `DataKey` object, which contains all of the values for the specified data key fields for that row.</span></span>

<span data-ttu-id="92c6f-147">`DataKeyNames`属性自动设置为唯一标识数据字段，数据源绑定到 GridView、 detailsview 和 FormView 通过设计器时。</span><span class="sxs-lookup"><span data-stu-id="92c6f-147">The `DataKeyNames` property is automatically set to the uniquely-identifying data field(s) when you bind a data source to a GridView, DetailsView, or FormView through the Designer.</span></span> <span data-ttu-id="92c6f-148">这些示例时设置此属性已为我们自动在前面的教程中，会不起作用`DataKeyNames`指定属性。</span><span class="sxs-lookup"><span data-stu-id="92c6f-148">While this property has been set for us automatically in the preceding tutorials, the examples would have worked without the `DataKeyNames` property specified.</span></span> <span data-ttu-id="92c6f-149">但是，在本教程中，可选择的 GridView 以及将来的教程中我们将检查插入、 更新和删除，`DataKeyNames`属性必须正确设置。</span><span class="sxs-lookup"><span data-stu-id="92c6f-149">However, for the selectable GridView in this tutorial, as well as for future tutorials in which we'll be examining inserting, updating, and deleting, the `DataKeyNames` property must be set properly.</span></span> <span data-ttu-id="92c6f-150">请花费片刻时间以确保你 GridView`DataKeyNames`属性设置为`ProductID`。</span><span class="sxs-lookup"><span data-stu-id="92c6f-150">Take a moment to ensure that your GridView's `DataKeyNames` property is set to `ProductID`.</span></span>

<span data-ttu-id="92c6f-151">让我们查看一下我们到目前为止通过浏览器的进度。</span><span class="sxs-lookup"><span data-stu-id="92c6f-151">Let's view our progress thus far through a browser.</span></span> <span data-ttu-id="92c6f-152">请注意 GridView 列出的名称和所有选择的 LinkButton 以及产品的价格。</span><span class="sxs-lookup"><span data-stu-id="92c6f-152">Note that the GridView lists the name and price for all of the products along with a Select LinkButton.</span></span> <span data-ttu-id="92c6f-153">单击选择按钮会导致回发。</span><span class="sxs-lookup"><span data-stu-id="92c6f-153">Clicking the Select button causes a postback.</span></span> <span data-ttu-id="92c6f-154">在步骤 2 中，我们将了解如何能够对此回发 DetailsView 响应通过显示所选产品的详细信息。</span><span class="sxs-lookup"><span data-stu-id="92c6f-154">In Step 2 we'll see how to have a DetailsView respond to this postback by displaying the details for the selected product.</span></span>


<span data-ttu-id="92c6f-155">[![每个产品行包含选择 LinkButton](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image20.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-155">[![Each Product Row Contains a Select LinkButton](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image20.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image19.png)</span></span>

<span data-ttu-id="92c6f-156">**图 7**： 每个产品行包含选择 LinkButton ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-156">**Figure 7**: Each Product Row Contains a Select LinkButton ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image21.png))</span></span>


## <a name="highlighting-the-selected-row"></a><span data-ttu-id="92c6f-157">突出显示所选的行</span><span class="sxs-lookup"><span data-stu-id="92c6f-157">Highlighting the Selected Row</span></span>

<span data-ttu-id="92c6f-158">`ProductsGrid` GridView 有`SelectedRowStyle`可用于指示所选行的视觉样式的属性。</span><span class="sxs-lookup"><span data-stu-id="92c6f-158">The `ProductsGrid` GridView has a `SelectedRowStyle` property that can be used to dictate the visual style for the selected row.</span></span> <span data-ttu-id="92c6f-159">使用得当，这可以通过多个清楚地显示当前选择的 GridView 的哪些行来提高用户的体验。</span><span class="sxs-lookup"><span data-stu-id="92c6f-159">Used properly, this can improve the user's experience by more clearly showing which row of the GridView is currently selected.</span></span> <span data-ttu-id="92c6f-160">本教程中，让我们用黄色背景突出显示所选的行。</span><span class="sxs-lookup"><span data-stu-id="92c6f-160">For this tutorial, let's have the selected row be highlighted with a yellow background.</span></span>

<span data-ttu-id="92c6f-161">如我们之前的教程，让我们致力于以保存美学相关的设置定义为 CSS 类。</span><span class="sxs-lookup"><span data-stu-id="92c6f-161">As with our earlier tutorials, let's strive to keep the aesthetic-related settings defined as CSS classes.</span></span> <span data-ttu-id="92c6f-162">因此，创建一个新的 CSS 类中`Styles.css`名为`SelectedRowStyle`。</span><span class="sxs-lookup"><span data-stu-id="92c6f-162">Therefore, create a new CSS class in `Styles.css` named `SelectedRowStyle`.</span></span>


[!code-css[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample3.css)]

<span data-ttu-id="92c6f-163">若要应用到此 CSS 类`SelectedRowStyle`的属性*所有*我们教程系列中的 Gridview 编辑`GridView.skin`外观中`DataWebControls`要包括的主题`SelectedRowStyle`设置，如下所示：</span><span class="sxs-lookup"><span data-stu-id="92c6f-163">To apply this CSS class to the `SelectedRowStyle` property of *all* GridViews in our tutorial series, edit the `GridView.skin` Skin in the `DataWebControls` Theme to include the `SelectedRowStyle` settings as shown below:</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample4.aspx)]

<span data-ttu-id="92c6f-164">添加此元素后，所选的 GridView 行现在已突出显示黄色背景颜色。</span><span class="sxs-lookup"><span data-stu-id="92c6f-164">With this addition, the selected GridView row is now highlighted with a yellow background color.</span></span>


<span data-ttu-id="92c6f-165">[![自定义所选的行的外观，可以使用 GridView 的 SelectedRowStyle 属性](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image23.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-165">[![Customize the Selected Row's Appearance Using the GridView's SelectedRowStyle Property](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image23.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image22.png)</span></span>

<span data-ttu-id="92c6f-166">**图 8**： 使用自定义所选行的外观 GridView`SelectedRowStyle`属性 ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-166">**Figure 8**: Customize the Selected Row's Appearance Using the GridView's `SelectedRowStyle` Property ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image24.png))</span></span>


## <a name="step-2-displaying-the-selected-products-details-in-a-detailsview"></a><span data-ttu-id="92c6f-167">步骤 2： 在 DetailsView 中显示所选的产品的详细信息</span><span class="sxs-lookup"><span data-stu-id="92c6f-167">Step 2: Displaying the Selected Product's Details in a DetailsView</span></span>

<span data-ttu-id="92c6f-168">使用`ProductsGrid`GridView 完成，所有要添加显示有关所选的特定产品的信息 DetailsView 就是。</span><span class="sxs-lookup"><span data-stu-id="92c6f-168">With the `ProductsGrid` GridView complete, all that remains is to add a DetailsView that displays information about the particular product selected.</span></span> <span data-ttu-id="92c6f-169">添加 GridView 上面的 DetailsView 控件并创建名为新 ObjectDataSource `ProductDetailsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="92c6f-169">Add a DetailsView control above the GridView and create a new ObjectDataSource named `ProductDetailsDataSource`.</span></span> <span data-ttu-id="92c6f-170">因为我们希望此 DetailsView 以显示有关所选产品的特定信息，请配置`ProductDetailsDataSource`若要使用`ProductsBLL`类的`GetProductByProductID(productID)`方法。</span><span class="sxs-lookup"><span data-stu-id="92c6f-170">Since we want this DetailsView to display particular information about the selected product, configure the `ProductDetailsDataSource` to use the `ProductsBLL` class's `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="92c6f-171">[![调用 ProductsBLL 类 GetProductByProductID(productID) 方法](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image26.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-171">[![Invoke the ProductsBLL Class's GetProductByProductID(productID) Method](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image26.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image25.png)</span></span>

<span data-ttu-id="92c6f-172">**图 9**： 调用`ProductsBLL`类的`GetProductByProductID(productID)`方法 ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-172">**Figure 9**: Invoke the `ProductsBLL` Class's `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image27.png))</span></span>


<span data-ttu-id="92c6f-173">具有*`productID`* 参数的值从 GridView 控件获取`SelectedValue`属性。</span><span class="sxs-lookup"><span data-stu-id="92c6f-173">Have the *`productID`* parameter's value obtained from the GridView control's `SelectedValue` property.</span></span> <span data-ttu-id="92c6f-174">如前面所述，GridView 的`SelectedValue`属性返回所选行的第一个数据键值。</span><span class="sxs-lookup"><span data-stu-id="92c6f-174">As we discussed earlier, the GridView's `SelectedValue` property returns the first data key value for the selected row.</span></span> <span data-ttu-id="92c6f-175">因此，它是命令性的 GridView`DataKeyNames`属性设置为`ProductID`，因此，所选的行`ProductID`返回值`SelectedValue`。</span><span class="sxs-lookup"><span data-stu-id="92c6f-175">Therefore, it's imperative that the GridView's `DataKeyNames` property is set to `ProductID`, so that the selected row's `ProductID` value is returned by `SelectedValue`.</span></span>


<span data-ttu-id="92c6f-176">[![将产品 id 参数设置为 GridView 的 SelectedValue 属性](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image29.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-176">[![Set the productID Parameter to the GridView's SelectedValue Property](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image29.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image28.png)</span></span>

<span data-ttu-id="92c6f-177">**图 10**： 设置*`productID`* GridView 的参数`SelectedValue`属性 ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-177">**Figure 10**: Set the *`productID`* Parameter to the GridView's `SelectedValue` Property ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image30.png))</span></span>


<span data-ttu-id="92c6f-178">一次`productDetailsDataSource`正确配置对象数据源并将其绑定到 DetailsView，本教程中已完成 ！</span><span class="sxs-lookup"><span data-stu-id="92c6f-178">Once the `productDetailsDataSource` ObjectDataSource has been configured correctly and bound to the DetailsView, this tutorial is complete!</span></span> <span data-ttu-id="92c6f-179">当首次访问页面时未选择行，因此 GridView`SelectedValue`属性返回`Nothing`。</span><span class="sxs-lookup"><span data-stu-id="92c6f-179">When the page is first visited no row is selected, so the GridView's `SelectedValue` property returns `Nothing`.</span></span> <span data-ttu-id="92c6f-180">由于不没有使用任何产品`NULL``ProductID`值，没有记录返回由`GetProductByProductID(productID)`方法，这意味着 DetailsView 不显示 （请参阅图 11）。</span><span class="sxs-lookup"><span data-stu-id="92c6f-180">Since there are no products with a `NULL` `ProductID` value, no records are returned by the `GetProductByProductID(productID)` method, meaning that the DetailsView isn't displayed (see Figure 11).</span></span> <span data-ttu-id="92c6f-181">单击某 GridView 一行的选择按钮，才会进行回发和刷新 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="92c6f-181">Upon clicking a GridView row's Select button, a postback ensues and the DetailsView is refreshed.</span></span> <span data-ttu-id="92c6f-182">这一次 GridView`SelectedValue`属性返回`ProductID`所选行的`GetProductByProductID(productID)`方法将返回`ProductsDataTable`以及有关该特定产品和 DetailsView 信息显示了这些详细信息 （请参阅图 12）。</span><span class="sxs-lookup"><span data-stu-id="92c6f-182">This time the GridView's `SelectedValue` property returns the `ProductID` of the selected row, the `GetProductByProductID(productID)` method returns a `ProductsDataTable` with information about that particular product, and the DetailsView shows these details (see Figure 12).</span></span>


<span data-ttu-id="92c6f-183">[![第一个访问，仅 GridView 显示时](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image32.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-183">[![When First Visited, Only the GridView is Displayed](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image32.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image31.png)</span></span>

<span data-ttu-id="92c6f-184">**图 11**： 首次访问时，将显示仅 GridView ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-184">**Figure 11**: When First Visited, Only the GridView is Displayed ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image33.png))</span></span>


<span data-ttu-id="92c6f-185">[![在选择某一行，显示产品的详细信息](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image35.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="92c6f-185">[![Upon Selecting a Row, the Product's Details are Displayed](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image35.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image34.png)</span></span>

<span data-ttu-id="92c6f-186">**图 12**： 在选择某一行，显示产品的详细信息 ([单击以查看实际尺寸的图像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="92c6f-186">**Figure 12**: Upon Selecting a Row, the Product's Details are Displayed ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image36.png))</span></span>


## <a name="summary"></a><span data-ttu-id="92c6f-187">总结</span><span class="sxs-lookup"><span data-stu-id="92c6f-187">Summary</span></span>

<span data-ttu-id="92c6f-188">在此环境及前面的三个教程中，我们已经看到许多用于显示母版/详细信息报表的方法。</span><span class="sxs-lookup"><span data-stu-id="92c6f-188">In this and the preceding three tutorials we've seen a number of techniques for displaying master/detail reports.</span></span> <span data-ttu-id="92c6f-189">在本教程中，我们探讨使用可选择 GridView 来存放主记录和 DetailsView 相同页面上显示有关所选的主记录的详细信息。</span><span class="sxs-lookup"><span data-stu-id="92c6f-189">In this tutorial we examined using a selectable GridView to house the master records and a DetailsView to display details about the selected master record on the same page.</span></span> <span data-ttu-id="92c6f-190">在之前的教程介绍了如何显示母版/详细信息报表使用 Dropdownlist 和上一个 web 页面，详细信息记录在另一台显示主记录。</span><span class="sxs-lookup"><span data-stu-id="92c6f-190">In the earlier tutorials we looked at how to display master/details reports using DropDownLists and displaying master records on one web page and detail records on another.</span></span>

<span data-ttu-id="92c6f-191">本教程最后会探讨母版/详细信息报表。</span><span class="sxs-lookup"><span data-stu-id="92c6f-191">This tutorial concludes our examination of master/detail reports.</span></span> <span data-ttu-id="92c6f-192">从下一教程，我们将开始我们的自定义格式设置使用 GridView、 DetailsView 和 FormView 的探索。</span><span class="sxs-lookup"><span data-stu-id="92c6f-192">Starting with the next tutorial we'll begin our exploration of customized formatting with the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="92c6f-193">我们将看到如何自定义基于绑定到它们的数据在这些控件的外观、 如何汇总在 GridView 的页脚中的数据以及如何使用模板来获取更高的控制布局。</span><span class="sxs-lookup"><span data-stu-id="92c6f-193">We'll see how to customize the appearance of these controls based on the data bound to them, how to summarize data in the GridView's footer, and how to use templates to obtain a greater degree of control over the layout.</span></span>

<span data-ttu-id="92c6f-194">快乐编程 ！</span><span class="sxs-lookup"><span data-stu-id="92c6f-194">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="92c6f-195">关于作者</span><span class="sxs-lookup"><span data-stu-id="92c6f-195">About the Author</span></span>

<span data-ttu-id="92c6f-196">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)的七个部 asp/ASP.NET 书籍并创办了作者[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年以来一直致力于 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="92c6f-196">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="92c6f-197">Scott 是独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="92c6f-197">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="92c6f-198">他最新著作是[ *Sams Teach 自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="92c6f-198">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="92c6f-199">他可以到达[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="92c6f-199">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="92c6f-200">或通过他的博客，其中，请参阅[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="92c6f-200">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="92c6f-201">特别感谢</span><span class="sxs-lookup"><span data-stu-id="92c6f-201">Special Thanks To</span></span>

<span data-ttu-id="92c6f-202">很多有用的审阅者已评审本系列教程。</span><span class="sxs-lookup"><span data-stu-id="92c6f-202">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="92c6f-203">本教程中的潜在顾客审阅者是 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="92c6f-203">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="92c6f-204">是否有兴趣查看我即将推出的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="92c6f-204">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="92c6f-205">如果是这样，给我在行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="92c6f-205">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="92c6f-206">上一篇</span><span class="sxs-lookup"><span data-stu-id="92c6f-206">Previous</span></span>](master-detail-filtering-across-two-pages-vb.md)
